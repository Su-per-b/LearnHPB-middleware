<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Functional Mockup Interface For EnergyPlus: xml_parser_cosim.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Functional Mockup Interface For EnergyPlus</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('xml__parser__cosim_8c.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">xml_parser_cosim.c</div>  </div>
</div>
<div class="contents">
<a href="xml__parser__cosim_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00002"></a>00002 
<a name="l00003"></a>00003 
<a name="l00004"></a>00004 
<a name="l00005"></a>00005 
<a name="l00006"></a>00006 
<a name="l00007"></a>00007 
<a name="l00008"></a>00008 
<a name="l00009"></a>00009 
<a name="l00010"></a>00010 
<a name="l00011"></a>00011 
<a name="l00012"></a>00012 
<a name="l00013"></a>00013 
<a name="l00014"></a>00014 
<a name="l00015"></a>00015 
<a name="l00016"></a>00016 
<a name="l00017"></a>00017 
<a name="l00018"></a>00018 
<a name="l00019"></a>00019 
<a name="l00020"></a>00020 
<a name="l00021"></a>00021 
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 
<a name="l00024"></a>00024 
<a name="l00025"></a>00025 
<a name="l00026"></a>00026 
<a name="l00027"></a>00027 
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 <span class="comment">/* ------------------------------------------------------------------------- </span>
<a name="l00030"></a>00030 <span class="comment"> * xml_Parser.c</span>
<a name="l00031"></a>00031 <span class="comment"> * A parser for file modelVariables.xml of an FMU.</span>
<a name="l00032"></a>00032 <span class="comment"> * The parser creates an AST (abstract syntax tree) for a given XML file.</span>
<a name="l00033"></a>00033 <span class="comment"> * The root node of the AST is of type ModelDescription.</span>
<a name="l00034"></a>00034 <span class="comment"> * Validation already performed by this parser</span>
<a name="l00035"></a>00035 <span class="comment"> * - check for match of open/close elements (performed by Expat)</span>
<a name="l00036"></a>00036 <span class="comment"> * - check element, attribute and enum value names, all case sensitive</span>
<a name="l00037"></a>00037 <span class="comment"> * - check for each element that is has the expected parent element</span>
<a name="l00038"></a>00038 <span class="comment"> * - check for correct sequence of elements</span>
<a name="l00039"></a>00039 <span class="comment"> * Validation to be performed by this parser</span>
<a name="l00040"></a>00040 <span class="comment"> * - check for each attribute value that it is of the expected type </span>
<a name="l00041"></a>00041 <span class="comment"> * - check that required attributes are present  </span>
<a name="l00042"></a>00042 <span class="comment"> * - check that all decalaredType values reference an existing Type</span>
<a name="l00043"></a>00043 <span class="comment"> * - check that dependencies are only declared for outputs and</span>
<a name="l00044"></a>00044 <span class="comment"> *   refer only to inputs</span>
<a name="l00045"></a>00045 <span class="comment"> * Copyright 2010 QTronic GmbH. All rights reserved. </span>
<a name="l00046"></a>00046 <span class="comment"> * -------------------------------------------------------------------------*/</span>
<a name="l00047"></a>00047 
<a name="l00048"></a>00048 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00049"></a>00049 <span class="preprocessor">#include &lt;assert.h&gt;</span>
<a name="l00050"></a>00050 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00051"></a>00051 <span class="preprocessor">#include &lt;limits.h&gt;</span>
<a name="l00052"></a>00052 <span class="preprocessor">#include &quot;<a class="code" href="xml__parser__cosim_8h.html">xml_parser_cosim.h</a>&quot;</span>
<a name="l00053"></a>00053 <span class="preprocessor">#include &quot;<a class="code" href="util_8h.html" title="utility functions">util.h</a>&quot;</span>  
<a name="l00054"></a>00054 
<a name="l00055"></a><a class="code" href="xml__parser__cosim_8h.html#a1dacbe49ed03276788f8f6352f8054c2">00055</a> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="xml__parser__cosim_8c.html#a1dacbe49ed03276788f8f6352f8054c2">elmNames</a>[<a class="code" href="xml__parser__cosim_8h.html#aa05cf21f5703eadc6ad0ec00b7570235">SIZEOF_ELM</a>] = { 
<a name="l00056"></a>00056     <span class="stringliteral">&quot;fmiModelDescription&quot;</span>,<span class="stringliteral">&quot;UnitDefinitions&quot;</span>,<span class="stringliteral">&quot;BaseUnit&quot;</span>,<span class="stringliteral">&quot;DisplayUnitDefinition&quot;</span>,<span class="stringliteral">&quot;TypeDefinitions&quot;</span>,
<a name="l00057"></a>00057     <span class="stringliteral">&quot;Type&quot;</span>,<span class="stringliteral">&quot;RealType&quot;</span>,<span class="stringliteral">&quot;IntegerType&quot;</span>,<span class="stringliteral">&quot;BooleanType&quot;</span>,<span class="stringliteral">&quot;StringType&quot;</span>,<span class="stringliteral">&quot;EnumerationType&quot;</span>,<span class="stringliteral">&quot;Item&quot;</span>,
<a name="l00058"></a>00058      <span class="stringliteral">&quot;DefaultExperiment&quot;</span>,<span class="stringliteral">&quot;VendorAnnotations&quot;</span>,<span class="stringliteral">&quot;Tool&quot;</span>,<span class="stringliteral">&quot;Annotation&quot;</span>, <span class="stringliteral">&quot;ModelVariables&quot;</span>,<span class="stringliteral">&quot;ScalarVariable&quot;</span>,
<a name="l00059"></a>00059     <span class="stringliteral">&quot;DirectDependency&quot;</span>, <span class="stringliteral">&quot;Name&quot;</span>, <span class="stringliteral">&quot;Real&quot;</span>, <span class="stringliteral">&quot;Integer&quot;</span>, <span class="stringliteral">&quot;Boolean&quot;</span>, <span class="stringliteral">&quot;String&quot;</span>, <span class="stringliteral">&quot;Enumeration&quot;</span>,
<a name="l00060"></a>00060     <span class="stringliteral">&quot;Implementation&quot;</span>, <span class="stringliteral">&quot;CoSimulation_StandAlone&quot;</span>, <span class="stringliteral">&quot;Capabilities&quot;</span>, <span class="comment">// Names for co-simulation</span>
<a name="l00061"></a>00061     <span class="stringliteral">&quot;CoSimulation_Tool&quot;</span>, <span class="stringliteral">&quot;CoSimulationModel&quot;</span>, <span class="comment">// Names for co-simulation</span>
<a name="l00062"></a>00062     <span class="stringliteral">&quot;File&quot;</span>
<a name="l00063"></a>00063 };
<a name="l00064"></a>00064 
<a name="l00065"></a><a class="code" href="xml__parser__cosim_8h.html#ad43413b3e633885aeb1fafea5deb5d57">00065</a> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="xml__parser__cosim_8c.html#ad43413b3e633885aeb1fafea5deb5d57">attNames</a>[<a class="code" href="xml__parser__cosim_8h.html#a190c4e51780576d19b61259e5d8e3126">SIZEOF_ATT</a>] = {
<a name="l00066"></a>00066     <span class="stringliteral">&quot;fmiVersion&quot;</span>,<span class="stringliteral">&quot;displayUnit&quot;</span>,<span class="stringliteral">&quot;gain&quot;</span>,<span class="stringliteral">&quot;offset&quot;</span>,<span class="stringliteral">&quot;unit&quot;</span>,<span class="stringliteral">&quot;name&quot;</span>,<span class="stringliteral">&quot;description&quot;</span>,<span class="stringliteral">&quot;quantity&quot;</span>, <span class="stringliteral">&quot;relativeQuantity&quot;</span>,
<a name="l00067"></a>00067     <span class="stringliteral">&quot;min&quot;</span>,<span class="stringliteral">&quot;max&quot;</span>,<span class="stringliteral">&quot;nominal&quot;</span>,<span class="stringliteral">&quot;declaredType&quot;</span>,<span class="stringliteral">&quot;start&quot;</span>,<span class="stringliteral">&quot;fixed&quot;</span>,<span class="stringliteral">&quot;startTime&quot;</span>,<span class="stringliteral">&quot;stopTime&quot;</span>,<span class="stringliteral">&quot;tolerance&quot;</span>,<span class="stringliteral">&quot;value&quot;</span>,
<a name="l00068"></a>00068     <span class="stringliteral">&quot;valueReference&quot;</span>,<span class="stringliteral">&quot;variability&quot;</span>,<span class="stringliteral">&quot;causality&quot;</span>,<span class="stringliteral">&quot;alias&quot;</span>, <span class="stringliteral">&quot;modelName&quot;</span>,<span class="stringliteral">&quot;modelIdentifier&quot;</span>,<span class="stringliteral">&quot;guid&quot;</span>,<span class="stringliteral">&quot;author&quot;</span>,
<a name="l00069"></a>00069     <span class="stringliteral">&quot;version&quot;</span>,<span class="stringliteral">&quot;generationTool&quot;</span>,<span class="stringliteral">&quot;generationDateAndTime&quot;</span>,<span class="stringliteral">&quot;variableNamingConvention&quot;</span>,<span class="stringliteral">&quot;numberOfContinuousStates&quot;</span>,
<a name="l00070"></a>00070     <span class="stringliteral">&quot;numberOfEventIndicators&quot;</span>,<span class="stringliteral">&quot;input&quot;</span>,
<a name="l00071"></a>00071     <span class="stringliteral">&quot;canHandleVariableCommunicationStepSize&quot;</span>, <span class="stringliteral">&quot;canHandleEvents&quot;</span>, <span class="stringliteral">&quot;canRejectSteps&quot;</span>, <span class="stringliteral">&quot;canInterpolateInputs&quot;</span>,
<a name="l00072"></a>00072     <span class="stringliteral">&quot;maxOutputDerivativeOrder&quot;</span>, <span class="stringliteral">&quot;canRunAsynchronuously&quot;</span>, <span class="stringliteral">&quot;canSignalEvents&quot;</span>, 
<a name="l00073"></a>00073     <span class="stringliteral">&quot;canBeInstantiatedOnlyOncePerProcess&quot;</span>, <span class="stringliteral">&quot;canNotUseMemoryManagementFunctions&quot;</span>,
<a name="l00074"></a>00074     <span class="stringliteral">&quot;entryPoint&quot;</span>, <span class="stringliteral">&quot;manualStart&quot;</span>, <span class="stringliteral">&quot;type&quot;</span>, <span class="stringliteral">&quot;file&quot;</span>
<a name="l00075"></a>00075 };
<a name="l00076"></a>00076 
<a name="l00077"></a><a class="code" href="xml__parser__cosim_8h.html#a5f179c5f60739cb1e097c4dba1e6c20a">00077</a> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="xml__parser__cosim_8c.html#a5f179c5f60739cb1e097c4dba1e6c20a">enuNames</a>[<a class="code" href="xml__parser__cosim_8h.html#a94e7acac9ae1c29c86bd5c1a19718de1">SIZEOF_ENU</a>] = {
<a name="l00078"></a>00078     <span class="stringliteral">&quot;flat&quot;</span>,<span class="stringliteral">&quot;structured&quot;</span>,<span class="stringliteral">&quot;constant&quot;</span>,<span class="stringliteral">&quot;parameter&quot;</span>,<span class="stringliteral">&quot;discrete&quot;</span>,<span class="stringliteral">&quot;continuous&quot;</span>,
<a name="l00079"></a>00079     <span class="stringliteral">&quot;input&quot;</span>,<span class="stringliteral">&quot;output&quot;</span>, <span class="stringliteral">&quot;internal&quot;</span>,<span class="stringliteral">&quot;none&quot;</span>,<span class="stringliteral">&quot;noAlias&quot;</span>,<span class="stringliteral">&quot;alias&quot;</span>,<span class="stringliteral">&quot;negatedAlias&quot;</span>
<a name="l00080"></a>00080 };
<a name="l00081"></a>00081 
<a name="l00082"></a>00082 
<a name="l00083"></a><a class="code" href="xml__parser__cosim_8c.html#ad11a2f38dcbf340c673b6a9b09ed7185">00083</a> <span class="preprocessor">#define ANY_TYPE -1</span>
<a name="l00084"></a><a class="code" href="xml__parser__cosim_8c.html#a0d052f24a8ae31bc7352f7e019223a0e">00084</a> <span class="preprocessor"></span><span class="preprocessor">#define XMLBUFSIZE 1024</span>
<a name="l00085"></a><a class="code" href="xml__parser__cosim_8c.html#ab35babda713de8db4d69c1f38c776b12">00085</a> <span class="preprocessor"></span><span class="keywordtype">char</span> <a class="code" href="xml__parser__cosim_8c.html#ab35babda713de8db4d69c1f38c776b12">text</a>[<a class="code" href="xml__parser__cosim_8c.html#a0d052f24a8ae31bc7352f7e019223a0e">XMLBUFSIZE</a>];       <span class="comment">// XML file is parsed in chunks of length XMLBUFZIZE</span>
<a name="l00086"></a><a class="code" href="xml__parser__cosim_8c.html#ae610b1239dcb18c41bb131788ca4b520">00086</a> <a class="code" href="expat_8h.html#a9dc0003156857c67b3a60b3993846013">XML_Parser</a> <a class="code" href="xml__parser__cosim_8c.html#ae610b1239dcb18c41bb131788ca4b520">parser</a> = NULL;    <span class="comment">// non-NULL during parsing</span>
<a name="l00087"></a><a class="code" href="xml__parser__cosim_8c.html#a4efbb5409daaa6e7ee513423ef977ee4">00087</a> <a class="code" href="structStack.html">Stack</a>* <a class="code" href="xml__parser__cosim_8c.html#a4efbb5409daaa6e7ee513423ef977ee4">stack</a> = NULL;         <span class="comment">// the parser stack</span>
<a name="l00088"></a><a class="code" href="xml__parser__cosim_8c.html#a91a70b77df95bd8b0830b49a094c2acb">00088</a> <span class="keywordtype">char</span>* <a class="code" href="expat_8h.html#a1330208ca988f17841d64208a3bc3935">data</a> = NULL;           <span class="comment">// buffer that holds element content, see handleData</span>
<a name="l00089"></a><a class="code" href="xml__parser__cosim_8c.html#ac957c246a7bf701c778beba4fb6b0e14">00089</a> <span class="keywordtype">int</span> <a class="code" href="xml__parser__cosim_8c.html#ac957c246a7bf701c778beba4fb6b0e14">skipData</a>=0;              <span class="comment">// 1 to ignore element content, 0 when recordig content</span>
<a name="l00090"></a>00090 
<a name="l00098"></a><a class="code" href="xml__parser__cosim_8h.html#a4173c22c77f0b3fd0a756c939f018010">00098</a> <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="xml__parser__cosim_8c.html#a4173c22c77f0b3fd0a756c939f018010" title="Get string.">getString</a>(<span class="keywordtype">void</span>* element, <a class="code" href="xml__parser__cosim_8h.html#a59159c2e4de0af530912e1e58c84bacf">Att</a> a){
<a name="l00099"></a>00099     <a class="code" href="structElement.html">Element</a>* e = (<a class="code" href="structElement.html">Element</a>*)element;
<a name="l00100"></a>00100     <span class="keyword">const</span> <span class="keywordtype">char</span>** attr = e-&gt;<a class="code" href="structElement.html#aaebbd64792617c5e74c37669a8e17795">attributes</a>;
<a name="l00101"></a>00101     <span class="keywordtype">int</span> <a class="code" href="fmuTemplate_8h.html#ad51f78a2c68c740b5b1d4fa9bda8500f">i</a>;
<a name="l00102"></a>00102     <span class="keywordflow">for</span> (i=0; i&lt;e-&gt;<a class="code" href="structElement.html#a53875a4f352401abdf5605c29b45e9ad">n</a>; i+=2)
<a name="l00103"></a>00103         <span class="keywordflow">if</span> (attr[i]==<a class="code" href="xml__parser__cosim_8c.html#ad43413b3e633885aeb1fafea5deb5d57">attNames</a>[a])
<a name="l00104"></a>00104             <span class="keywordflow">return</span> attr[i+1];
<a name="l00105"></a>00105     <span class="keywordflow">return</span> NULL;
<a name="l00106"></a>00106 }
<a name="l00107"></a>00107 
<a name="l00115"></a><a class="code" href="xml__parser__cosim_8h.html#ae1badf188b772fe986a48dd14b4497a1">00115</a> <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="xml__parser__cosim_8c.html#ae1badf188b772fe986a48dd14b4497a1" title="Get string.">getMyString</a>(<a class="code" href="structModelDescription.html">ModelDescription</a>* element, <a class="code" href="xml__parser__cosim_8h.html#a59159c2e4de0af530912e1e58c84bacf">Att</a> a){
<a name="l00116"></a>00116     <a class="code" href="structElement.html">Element</a>* e = (<a class="code" href="structElement.html">Element</a>*)element;
<a name="l00117"></a>00117     <span class="keyword">const</span> <span class="keywordtype">char</span>** attr = e-&gt;<a class="code" href="structElement.html#aaebbd64792617c5e74c37669a8e17795">attributes</a>;
<a name="l00118"></a>00118     <span class="keywordtype">int</span> <a class="code" href="fmuTemplate_8h.html#ad51f78a2c68c740b5b1d4fa9bda8500f">i</a>;
<a name="l00119"></a>00119     <span class="keywordflow">for</span> (i=0; i&lt;e-&gt;<a class="code" href="structElement.html#a53875a4f352401abdf5605c29b45e9ad">n</a>; i+=2)
<a name="l00120"></a>00120         <span class="keywordflow">if</span> (attr[i]==<a class="code" href="xml__parser__cosim_8c.html#ad43413b3e633885aeb1fafea5deb5d57">attNames</a>[a])
<a name="l00121"></a>00121             <span class="keywordflow">return</span> attr[i+1];
<a name="l00122"></a>00122     <span class="keywordflow">return</span> NULL;
<a name="l00123"></a>00123 }
<a name="l00124"></a>00124 
<a name="l00133"></a><a class="code" href="xml__parser__cosim_8h.html#a5e09da4c6b2ae17bcd01293f87b6a589">00133</a> <span class="keywordtype">double</span> <a class="code" href="xml__parser__cosim_8c.html#a5e09da4c6b2ae17bcd01293f87b6a589" title="Get real value.">getDouble</a>(<span class="keywordtype">void</span>* element, <a class="code" href="xml__parser__cosim_8h.html#a59159c2e4de0af530912e1e58c84bacf">Att</a> a, <a class="code" href="xml__parser__cosim_8h.html#a4cb71a221c69f3395d9fb2369cfb7e9b">ValueStatus</a>* vs){
<a name="l00134"></a>00134     <span class="keywordtype">double</span> d = 0;
<a name="l00135"></a>00135     <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="expat_8h.html#a4a30a13b813682e68c5b689b45c65971">value</a> = <a class="code" href="xml__parser__cosim_8c.html#a4173c22c77f0b3fd0a756c939f018010" title="Get string.">getString</a>(element, a);
<a name="l00136"></a>00136     <span class="keywordflow">if</span> (!value) { *vs=<a class="code" href="xml__parser__cosim_8h.html#a4cb71a221c69f3395d9fb2369cfb7e9ba944078a6b0de97769a56b385f56f9fcf">valueMissing</a>; <span class="keywordflow">return</span> d; }
<a name="l00137"></a>00137     *vs = (1==sscanf(value, <span class="stringliteral">&quot;%lf&quot;</span>, &amp;d)) ? <a class="code" href="xml__parser__cosim_8h.html#a4cb71a221c69f3395d9fb2369cfb7e9ba88b960faf03ff59bf315a2a7353aa1ed">valueDefined</a> : <a class="code" href="xml__parser__cosim_8h.html#a4cb71a221c69f3395d9fb2369cfb7e9bac98090842216cd0c09efc3ca8b1de6ad">valueIllegal</a>;
<a name="l00138"></a>00138     <span class="keywordflow">return</span> d;    
<a name="l00139"></a>00139 }
<a name="l00140"></a>00140 
<a name="l00150"></a><a class="code" href="xml__parser__cosim_8h.html#a2bd3a41ecbff796de297238aab57db92">00150</a> <span class="keywordtype">int</span> <a class="code" href="xml__parser__cosim_8c.html#a2bd3a41ecbff796de297238aab57db92" title="Retrieve Enumeration values from XML, e.g.">getInt</a>(<span class="keywordtype">void</span>* element, <a class="code" href="xml__parser__cosim_8h.html#a59159c2e4de0af530912e1e58c84bacf">Att</a> a, <a class="code" href="xml__parser__cosim_8h.html#a4cb71a221c69f3395d9fb2369cfb7e9b">ValueStatus</a>* vs){
<a name="l00151"></a>00151     <span class="keywordtype">int</span> n = 0;
<a name="l00152"></a>00152     <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="expat_8h.html#a4a30a13b813682e68c5b689b45c65971">value</a> = <a class="code" href="xml__parser__cosim_8c.html#a4173c22c77f0b3fd0a756c939f018010" title="Get string.">getString</a>(element, a);
<a name="l00153"></a>00153     <span class="keywordflow">if</span> (!value) { *vs=<a class="code" href="xml__parser__cosim_8h.html#a4cb71a221c69f3395d9fb2369cfb7e9ba944078a6b0de97769a56b385f56f9fcf">valueMissing</a>; <span class="keywordflow">return</span> n; }
<a name="l00154"></a>00154     *vs = (1==sscanf(value, <span class="stringliteral">&quot;%d&quot;</span>, &amp;n)) ? <a class="code" href="xml__parser__cosim_8h.html#a4cb71a221c69f3395d9fb2369cfb7e9ba88b960faf03ff59bf315a2a7353aa1ed">valueDefined</a> : <a class="code" href="xml__parser__cosim_8h.html#a4cb71a221c69f3395d9fb2369cfb7e9bac98090842216cd0c09efc3ca8b1de6ad">valueIllegal</a>;
<a name="l00155"></a>00155     <span class="keywordflow">return</span> n;    
<a name="l00156"></a>00156 }
<a name="l00157"></a>00157 
<a name="l00166"></a><a class="code" href="xml__parser__cosim_8h.html#a30968d97c1925be03af04dfed98b71e2">00166</a> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="xml__parser__cosim_8c.html#a30968d97c1925be03af04dfed98b71e2" title="Get unsigned integer.">getUInt</a>(<span class="keywordtype">void</span>* element, <a class="code" href="xml__parser__cosim_8h.html#a59159c2e4de0af530912e1e58c84bacf">Att</a> a, <a class="code" href="xml__parser__cosim_8h.html#a4cb71a221c69f3395d9fb2369cfb7e9b">ValueStatus</a>* vs){
<a name="l00167"></a>00167     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> u = -1;
<a name="l00168"></a>00168     <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="expat_8h.html#a4a30a13b813682e68c5b689b45c65971">value</a> = <a class="code" href="xml__parser__cosim_8c.html#a4173c22c77f0b3fd0a756c939f018010" title="Get string.">getString</a>(element, a);
<a name="l00169"></a>00169     <span class="keywordflow">if</span> (!value) { *vs=<a class="code" href="xml__parser__cosim_8h.html#a4cb71a221c69f3395d9fb2369cfb7e9ba944078a6b0de97769a56b385f56f9fcf">valueMissing</a>; <span class="keywordflow">return</span> u; }
<a name="l00170"></a>00170     *vs = (1==sscanf(value, <span class="stringliteral">&quot;%u&quot;</span>, &amp;u)) ? <a class="code" href="xml__parser__cosim_8h.html#a4cb71a221c69f3395d9fb2369cfb7e9ba88b960faf03ff59bf315a2a7353aa1ed">valueDefined</a> : <a class="code" href="xml__parser__cosim_8h.html#a4cb71a221c69f3395d9fb2369cfb7e9bac98090842216cd0c09efc3ca8b1de6ad">valueIllegal</a>;
<a name="l00171"></a>00171     <span class="keywordflow">return</span> u;    
<a name="l00172"></a>00172 }
<a name="l00173"></a>00173 
<a name="l00182"></a><a class="code" href="xml__parser__cosim_8h.html#aa5e0dc28c2864d808a63bb65f8d0c68f">00182</a> <span class="keywordtype">char</span> <a class="code" href="xml__parser__cosim_8c.html#aa5e0dc28c2864d808a63bb65f8d0c68f" title="Get the boolean value.">getBoolean</a>(<span class="keywordtype">void</span>* element, <a class="code" href="xml__parser__cosim_8h.html#a59159c2e4de0af530912e1e58c84bacf">Att</a> a, <a class="code" href="xml__parser__cosim_8h.html#a4cb71a221c69f3395d9fb2369cfb7e9b">ValueStatus</a>* vs){
<a name="l00183"></a>00183     <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="expat_8h.html#a4a30a13b813682e68c5b689b45c65971">value</a> = <a class="code" href="xml__parser__cosim_8c.html#a4173c22c77f0b3fd0a756c939f018010" title="Get string.">getString</a>(element, a);
<a name="l00184"></a>00184     <span class="keywordflow">if</span> (!value) { *vs=<a class="code" href="xml__parser__cosim_8h.html#a4cb71a221c69f3395d9fb2369cfb7e9ba944078a6b0de97769a56b385f56f9fcf">valueMissing</a>; <span class="keywordflow">return</span> 0; };
<a name="l00185"></a>00185     *vs = <a class="code" href="xml__parser__cosim_8h.html#a4cb71a221c69f3395d9fb2369cfb7e9ba88b960faf03ff59bf315a2a7353aa1ed">valueDefined</a>;
<a name="l00186"></a>00186     <span class="keywordflow">if</span> (!strcmp(value, <span class="stringliteral">&quot;true&quot;</span>)) <span class="keywordflow">return</span> 1;
<a name="l00187"></a>00187     <span class="keywordflow">if</span> (!strcmp(value, <span class="stringliteral">&quot;false&quot;</span>)) <span class="keywordflow">return</span> 0;
<a name="l00188"></a>00188     *vs = <a class="code" href="xml__parser__cosim_8h.html#a4cb71a221c69f3395d9fb2369cfb7e9bac98090842216cd0c09efc3ca8b1de6ad">valueIllegal</a>;    
<a name="l00189"></a>00189     <span class="keywordflow">return</span> 0;
<a name="l00190"></a>00190 }
<a name="l00191"></a>00191 
<a name="l00192"></a>00192 <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="xml__parser__cosim_8c.html#a53596f97ec1e04d04bc7a6eac85d9381" title="Check enum value of input string enu.">checkEnumValue</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* enu);
<a name="l00193"></a>00193 
<a name="l00203"></a><a class="code" href="xml__parser__cosim_8h.html#af46c5de40a947d5356ee3b71b7e14156">00203</a> <a class="code" href="xml__parser__cosim_8h.html#aea7ea6e61f6b28ce9df951528de712ba">Enu</a> <a class="code" href="xml__parser__cosim_8c.html#af46c5de40a947d5356ee3b71b7e14156" title="Retrieve the value of the given built-in enum attribute.">getEnumValue</a>(<span class="keywordtype">void</span>* element, <a class="code" href="xml__parser__cosim_8h.html#a59159c2e4de0af530912e1e58c84bacf">Att</a> a, <a class="code" href="xml__parser__cosim_8h.html#a4cb71a221c69f3395d9fb2369cfb7e9b">ValueStatus</a>* vs) {
<a name="l00204"></a>00204     <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="expat_8h.html#a4a30a13b813682e68c5b689b45c65971">value</a> = <a class="code" href="xml__parser__cosim_8c.html#a4173c22c77f0b3fd0a756c939f018010" title="Get string.">getString</a>(element, a);
<a name="l00205"></a>00205     <a class="code" href="xml__parser__cosim_8h.html#aea7ea6e61f6b28ce9df951528de712ba">Enu</a> <span class="keywordtype">id</span> = <a class="code" href="xml__parser__cosim_8h.html#a4cb71a221c69f3395d9fb2369cfb7e9ba88b960faf03ff59bf315a2a7353aa1ed">valueDefined</a>;
<a name="l00206"></a>00206     <span class="keywordflow">if</span> (!value) { 
<a name="l00207"></a>00207         *vs = <a class="code" href="xml__parser__cosim_8h.html#a4cb71a221c69f3395d9fb2369cfb7e9ba944078a6b0de97769a56b385f56f9fcf">valueMissing</a>;
<a name="l00208"></a>00208         <span class="keywordflow">switch</span> (a) {
<a name="l00209"></a>00209             <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a59159c2e4de0af530912e1e58c84bacfa792671fca5f13969d4f067bdcc3d6ad1">att_variableNamingConvention</a>: <span class="keywordflow">return</span> <a class="code" href="xml__parser__cosim_8h.html#aea7ea6e61f6b28ce9df951528de712baacffd9d6606986e1bd419faa3a9ba059a">enu_flat</a>;
<a name="l00210"></a>00210             <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a59159c2e4de0af530912e1e58c84bacfa3b7a60a2bde338ac409fdf5ea8154d5a">att_variability</a>: <span class="keywordflow">return</span> <a class="code" href="xml__parser__cosim_8h.html#aea7ea6e61f6b28ce9df951528de712baab92b66bef51091b462922f2f213e016d">enu_continuous</a>;
<a name="l00211"></a>00211             <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a59159c2e4de0af530912e1e58c84bacfaa8f42f378ff96d9bf90d9ec427c9ed7a">att_causality</a>: <span class="keywordflow">return</span> <a class="code" href="xml__parser__cosim_8h.html#aea7ea6e61f6b28ce9df951528de712baa5eb20a59ac4d085d69cfc0527356765d">enu_internal</a>;
<a name="l00212"></a>00212             <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a59159c2e4de0af530912e1e58c84bacfafd5760813cb41747654cdb10c074ffc3">att_alias</a>: <span class="keywordflow">return</span> <a class="code" href="xml__parser__cosim_8h.html#aea7ea6e61f6b28ce9df951528de712baa718ec103eaae3fcb5dab6d9076dd7e4b">enu_noAlias</a>;
<a name="l00213"></a>00213             <span class="keywordflow">default</span>: <span class="keywordflow">return</span> -1;
<a name="l00214"></a>00214         }
<a name="l00215"></a>00215     }
<a name="l00216"></a>00216     <span class="keywordtype">id</span> = <a class="code" href="xml__parser__cosim_8c.html#a53596f97ec1e04d04bc7a6eac85d9381" title="Check enum value of input string enu.">checkEnumValue</a>(value);
<a name="l00217"></a>00217     <span class="keywordflow">if</span> (<span class="keywordtype">id</span>==-1) *vs = <a class="code" href="xml__parser__cosim_8h.html#a4cb71a221c69f3395d9fb2369cfb7e9bac98090842216cd0c09efc3ca8b1de6ad">valueIllegal</a>; 
<a name="l00218"></a>00218     <span class="keywordflow">return</span> id;
<a name="l00219"></a>00219 }
<a name="l00220"></a>00220 
<a name="l00229"></a><a class="code" href="xml__parser__cosim_8h.html#aef3634637021d01f8ea8d5765455a01b">00229</a> <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="xml__parser__cosim_8c.html#aef3634637021d01f8ea8d5765455a01b" title="Get model identifier.">getModelIdentifier</a>(<a class="code" href="structModelDescription.html">ModelDescription</a>* md) {
<a name="l00230"></a>00230     <span class="comment">//const char* modelId = getString(md, att_modelIdentifier);</span>
<a name="l00231"></a>00231     <span class="keyword">const</span> <span class="keywordtype">char</span>* modelId = <a class="code" href="xml__parser__cosim_8c.html#ae1badf188b772fe986a48dd14b4497a1" title="Get string.">getMyString</a>(md, <a class="code" href="xml__parser__cosim_8h.html#a59159c2e4de0af530912e1e58c84bacfa89ed08868e265751ef08d68266189852">att_modelIdentifier</a>);
<a name="l00232"></a>00232     assert(modelId); <span class="comment">// this is a required attribute</span>
<a name="l00233"></a>00233     <span class="keywordflow">return</span> modelId;
<a name="l00234"></a>00234 }
<a name="l00235"></a>00235 
<a name="l00242"></a><a class="code" href="xml__parser__cosim_8h.html#aae9360ed09bf957bff4f745e7bc0b28d">00242</a> <span class="keywordtype">int</span> <a class="code" href="xml__parser__cosim_8c.html#aae9360ed09bf957bff4f745e7bc0b28d" title="Get number of states.">getNumberOfStates</a>(<a class="code" href="structModelDescription.html">ModelDescription</a>* md) {
<a name="l00243"></a>00243     <a class="code" href="xml__parser__cosim_8h.html#a4cb71a221c69f3395d9fb2369cfb7e9b">ValueStatus</a> vs;
<a name="l00244"></a>00244     <span class="keywordtype">int</span> n = <a class="code" href="xml__parser__cosim_8c.html#a30968d97c1925be03af04dfed98b71e2" title="Get unsigned integer.">getUInt</a>(md, <a class="code" href="xml__parser__cosim_8h.html#a59159c2e4de0af530912e1e58c84bacfae6beb77962dadfab8355463c3c0dcf20">att_numberOfContinuousStates</a>, &amp;vs);
<a name="l00245"></a>00245     assert(vs==<a class="code" href="xml__parser__cosim_8h.html#a4cb71a221c69f3395d9fb2369cfb7e9ba88b960faf03ff59bf315a2a7353aa1ed">valueDefined</a>); <span class="comment">// this is a required attribute</span>
<a name="l00246"></a>00246     <span class="keywordflow">return</span> n;
<a name="l00247"></a>00247 }
<a name="l00248"></a>00248 
<a name="l00255"></a><a class="code" href="xml__parser__cosim_8h.html#ad156aa2179eda7dac57f480bcfcd2274">00255</a> <span class="keywordtype">int</span> <a class="code" href="xml__parser__cosim_8c.html#ad156aa2179eda7dac57f480bcfcd2274" title="Get number of event indicators.">getNumberOfEventIndicators</a>(<a class="code" href="structModelDescription.html">ModelDescription</a>* md) {
<a name="l00256"></a>00256     <a class="code" href="xml__parser__cosim_8h.html#a4cb71a221c69f3395d9fb2369cfb7e9b">ValueStatus</a> vs;
<a name="l00257"></a>00257     <span class="keywordtype">int</span> n = <a class="code" href="xml__parser__cosim_8c.html#a2bd3a41ecbff796de297238aab57db92" title="Retrieve Enumeration values from XML, e.g.">getInt</a>(md, <a class="code" href="xml__parser__cosim_8h.html#a59159c2e4de0af530912e1e58c84bacfa6a7a9d3d6578e34fa63952b47cef75f9">att_numberOfEventIndicators</a>, &amp;vs);
<a name="l00258"></a>00258     assert(vs==<a class="code" href="xml__parser__cosim_8h.html#a4cb71a221c69f3395d9fb2369cfb7e9ba88b960faf03ff59bf315a2a7353aa1ed">valueDefined</a>); <span class="comment">// this is a required attribute</span>
<a name="l00259"></a>00259     <span class="keywordflow">return</span> n;
<a name="l00260"></a>00260 }
<a name="l00261"></a>00261 
<a name="l00269"></a><a class="code" href="xml__parser__cosim_8h.html#ac5d9dc6a672aef4c044285da7b26f5a9">00269</a> <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="xml__parser__cosim_8c.html#ac5d9dc6a672aef4c044285da7b26f5a9" title="Get name.">getName</a>(<span class="keywordtype">void</span>* element) { 
<a name="l00270"></a>00270     <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="expat_8h.html#a1b49b495b59f9e73205b69ad1a2965b0">name</a> = <a class="code" href="xml__parser__cosim_8c.html#a4173c22c77f0b3fd0a756c939f018010" title="Get string.">getString</a>(element, <a class="code" href="xml__parser__cosim_8h.html#a59159c2e4de0af530912e1e58c84bacfad81aacf75a84ad2cf22e353291373913">att_name</a>);
<a name="l00271"></a>00271     assert(name); <span class="comment">// this is a required attribute</span>
<a name="l00272"></a>00272     <span class="keywordflow">return</span> <a class="code" href="expat_8h.html#a1b49b495b59f9e73205b69ad1a2965b0">name</a>;
<a name="l00273"></a>00273 }
<a name="l00274"></a>00274 
<a name="l00282"></a><a class="code" href="xml__parser__cosim_8h.html#a55b615252e4dc50369cdf368c526cd38">00282</a> <a class="code" href="xml__parser__cosim_8h.html#aea7ea6e61f6b28ce9df951528de712ba">Enu</a> <a class="code" href="xml__parser__cosim_8c.html#a55b615252e4dc50369cdf368c526cd38" title="Get causality.">getCausality</a>(<span class="keywordtype">void</span>* scalarVariable) {
<a name="l00283"></a>00283     <a class="code" href="xml__parser__cosim_8h.html#a4cb71a221c69f3395d9fb2369cfb7e9b">ValueStatus</a> vs;
<a name="l00284"></a>00284     <span class="keywordflow">return</span> <a class="code" href="xml__parser__cosim_8c.html#af46c5de40a947d5356ee3b71b7e14156" title="Retrieve the value of the given built-in enum attribute.">getEnumValue</a>(scalarVariable, <a class="code" href="xml__parser__cosim_8h.html#a59159c2e4de0af530912e1e58c84bacfaa8f42f378ff96d9bf90d9ec427c9ed7a">att_causality</a>, &amp;vs);
<a name="l00285"></a>00285 }
<a name="l00286"></a>00286 
<a name="l00294"></a><a class="code" href="xml__parser__cosim_8h.html#a58befb19d8fde9ba9ad41c5149c89ba1">00294</a> <a class="code" href="xml__parser__cosim_8h.html#aea7ea6e61f6b28ce9df951528de712ba">Enu</a> <a class="code" href="xml__parser__cosim_8c.html#a58befb19d8fde9ba9ad41c5149c89ba1" title="Get variablity.">getVariability</a>(<span class="keywordtype">void</span>* scalarVariable) {
<a name="l00295"></a>00295     <a class="code" href="xml__parser__cosim_8h.html#a4cb71a221c69f3395d9fb2369cfb7e9b">ValueStatus</a> vs;
<a name="l00296"></a>00296     <span class="keywordflow">return</span> <a class="code" href="xml__parser__cosim_8c.html#af46c5de40a947d5356ee3b71b7e14156" title="Retrieve the value of the given built-in enum attribute.">getEnumValue</a>(scalarVariable, <a class="code" href="xml__parser__cosim_8h.html#a59159c2e4de0af530912e1e58c84bacfa3b7a60a2bde338ac409fdf5ea8154d5a">att_variability</a>, &amp;vs);
<a name="l00297"></a>00297 }
<a name="l00298"></a>00298 
<a name="l00306"></a><a class="code" href="xml__parser__cosim_8h.html#ad6d56a92ea398f84c24ae5328a0bcebd">00306</a> <a class="code" href="xml__parser__cosim_8h.html#aea7ea6e61f6b28ce9df951528de712ba">Enu</a> <a class="code" href="xml__parser__cosim_8c.html#ad6d56a92ea398f84c24ae5328a0bcebd" title="Get alias.">getAlias</a>(<span class="keywordtype">void</span>* scalarVariable) {
<a name="l00307"></a>00307     <a class="code" href="xml__parser__cosim_8h.html#a4cb71a221c69f3395d9fb2369cfb7e9b">ValueStatus</a> vs;
<a name="l00308"></a>00308     <span class="keywordflow">return</span> <a class="code" href="xml__parser__cosim_8c.html#af46c5de40a947d5356ee3b71b7e14156" title="Retrieve the value of the given built-in enum attribute.">getEnumValue</a>(scalarVariable, <a class="code" href="xml__parser__cosim_8h.html#a59159c2e4de0af530912e1e58c84bacfafd5760813cb41747654cdb10c074ffc3">att_alias</a>, &amp;vs);
<a name="l00309"></a>00309 }
<a name="l00310"></a>00310 
<a name="l00320"></a><a class="code" href="xml__parser__cosim_8h.html#ade04f5555b0436f91e98211ba3bcb9e2">00320</a> <a class="code" href="common_2fmiModelTypes_8h.html#a391754b90ab44cfcc77cd56acebeb657">fmiValueReference</a> <a class="code" href="xml__parser__cosim_8c.html#ade04f5555b0436f91e98211ba3bcb9e2" title="Get value reference.">getValueReference</a>(<span class="keywordtype">void</span>* scalarVariable) {
<a name="l00321"></a>00321     <a class="code" href="xml__parser__cosim_8h.html#a4cb71a221c69f3395d9fb2369cfb7e9b">ValueStatus</a> vs;
<a name="l00322"></a>00322     <a class="code" href="common_2fmiModelTypes_8h.html#a391754b90ab44cfcc77cd56acebeb657">fmiValueReference</a> vr = <a class="code" href="xml__parser__cosim_8c.html#a30968d97c1925be03af04dfed98b71e2" title="Get unsigned integer.">getUInt</a>(scalarVariable, <a class="code" href="xml__parser__cosim_8h.html#a59159c2e4de0af530912e1e58c84bacfa5c22528bec9da555d7555cc58ff0f637">att_valueReference</a>, &amp;vs);
<a name="l00323"></a>00323     assert(((<a class="code" href="structElement.html">Element</a>*)scalarVariable)-&gt;type == <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa839bc3580841101552970a9a3857134b">elm_ScalarVariable</a>);
<a name="l00324"></a>00324     assert(vs==<a class="code" href="xml__parser__cosim_8h.html#a4cb71a221c69f3395d9fb2369cfb7e9ba88b960faf03ff59bf315a2a7353aa1ed">valueDefined</a>); <span class="comment">// this is a reqired attribute</span>
<a name="l00325"></a>00325     <span class="keywordflow">return</span> vr;
<a name="l00326"></a>00326 }
<a name="l00327"></a>00327 
<a name="l00335"></a><a class="code" href="xml__parser__cosim_8h.html#adbefe1dce7574e005fdf751ed986c082">00335</a> <a class="code" href="structScalarVariable.html">ScalarVariable</a>* <a class="code" href="xml__parser__cosim_8c.html#adbefe1dce7574e005fdf751ed986c082" title="Get the varible by its unique name.">getVariableByName</a>(<a class="code" href="structModelDescription.html">ModelDescription</a>* md, <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="expat_8h.html#a1b49b495b59f9e73205b69ad1a2965b0">name</a>) {
<a name="l00336"></a>00336     <span class="keywordtype">int</span> <a class="code" href="fmuTemplate_8h.html#ad51f78a2c68c740b5b1d4fa9bda8500f">i</a>;
<a name="l00337"></a>00337     <span class="keywordflow">if</span> (md-&gt;<a class="code" href="structModelDescription.html#a06f6c51301bd9921b391a7b7584b945e">modelVariables</a>)
<a name="l00338"></a>00338     <span class="keywordflow">for</span> (i=0; md-&gt;<a class="code" href="structModelDescription.html#a06f6c51301bd9921b391a7b7584b945e">modelVariables</a>[<a class="code" href="fmuTemplate_8h.html#ad51f78a2c68c740b5b1d4fa9bda8500f">i</a>]; i++){
<a name="l00339"></a>00339         <a class="code" href="structScalarVariable.html">ScalarVariable</a>* sv = (<a class="code" href="structScalarVariable.html">ScalarVariable</a>*)md-&gt;<a class="code" href="structModelDescription.html#a06f6c51301bd9921b391a7b7584b945e">modelVariables</a>[i];
<a name="l00340"></a>00340         if (!strcmp(<a class="code" href="xml__parser__cosim_8c.html#ac5d9dc6a672aef4c044285da7b26f5a9" title="Get name.">getName</a>(sv), name)) <span class="keywordflow">return</span> sv;
<a name="l00341"></a>00341     }
<a name="l00342"></a>00342     <span class="keywordflow">return</span> NULL;
<a name="l00343"></a>00343 }
<a name="l00344"></a>00344 
<a name="l00354"></a><a class="code" href="xml__parser__cosim_8c.html#a49bc86d377841b38b12ba9ce40bee1b6">00354</a> <span class="keywordtype">int</span> <a class="code" href="xml__parser__cosim_8c.html#a49bc86d377841b38b12ba9ce40bee1b6" title="Check if elements t1 and t2 have the same base type.">sameBaseType</a>(<a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668f">Elm</a> t1, <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668f">Elm</a> t2){
<a name="l00355"></a>00355     <span class="keywordflow">return</span> t1==t2 || 
<a name="l00356"></a>00356            t1==<a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa49bd7edeb15a16ec96fe458782879cec">elm_Enumeration</a> &amp;&amp; t2==<a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa31fb1361c495778fa9e495771fcaa94c">elm_Integer</a> || 
<a name="l00357"></a>00357            t2==<a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa49bd7edeb15a16ec96fe458782879cec">elm_Enumeration</a> &amp;&amp; t1==<a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa31fb1361c495778fa9e495771fcaa94c">elm_Integer</a>;
<a name="l00358"></a>00358 }
<a name="l00359"></a>00359 
<a name="l00368"></a><a class="code" href="xml__parser__cosim_8h.html#a15ff0a4f305bf3463b10901838ca7382">00368</a> <a class="code" href="structScalarVariable.html">ScalarVariable</a>* <a class="code" href="xml__parser__cosim_8c.html#a15ff0a4f305bf3463b10901838ca7382" title="Get scalar variable.">getVariable</a>(<a class="code" href="structModelDescription.html">ModelDescription</a>* md, <a class="code" href="common_2fmiModelTypes_8h.html#a391754b90ab44cfcc77cd56acebeb657">fmiValueReference</a> vr, <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668f">Elm</a> type){
<a name="l00369"></a>00369     <span class="keywordtype">int</span> <a class="code" href="fmuTemplate_8h.html#ad51f78a2c68c740b5b1d4fa9bda8500f">i</a>;
<a name="l00370"></a>00370     <span class="keywordflow">if</span> (md-&gt;<a class="code" href="structModelDescription.html#a06f6c51301bd9921b391a7b7584b945e">modelVariables</a> &amp;&amp; vr!=<a class="code" href="common_2fmiModelTypes_8h.html#a11874965620c8d77395f5401de5903b5">fmiUndefinedValueReference</a>)
<a name="l00371"></a>00371     <span class="keywordflow">for</span> (i=0; md-&gt;<a class="code" href="structModelDescription.html#a06f6c51301bd9921b391a7b7584b945e">modelVariables</a>[<a class="code" href="fmuTemplate_8h.html#ad51f78a2c68c740b5b1d4fa9bda8500f">i</a>]; i++){
<a name="l00372"></a>00372         <a class="code" href="structScalarVariable.html">ScalarVariable</a>* sv = (<a class="code" href="structScalarVariable.html">ScalarVariable</a>*)md-&gt;<a class="code" href="structModelDescription.html#a06f6c51301bd9921b391a7b7584b945e">modelVariables</a>[i];
<a name="l00373"></a>00373         if (<a class="code" href="xml__parser__cosim_8c.html#a49bc86d377841b38b12ba9ce40bee1b6" title="Check if elements t1 and t2 have the same base type.">sameBaseType</a>(type, sv-&gt;<a class="code" href="structScalarVariable.html#a3563abf1de77f1e99c86851aefaa7650">typeSpec</a>-&gt;<a class="code" href="structElement.html#a7b29ec1313f99517acb89211871fdd34">type</a>) &amp;&amp; <a class="code" href="xml__parser__cosim_8c.html#ade04f5555b0436f91e98211ba3bcb9e2" title="Get value reference.">getValueReference</a>(sv) == vr) 
<a name="l00374"></a>00374             <span class="keywordflow">return</span> sv;
<a name="l00375"></a>00375     }
<a name="l00376"></a>00376     <span class="keywordflow">return</span> NULL;
<a name="l00377"></a>00377 }
<a name="l00378"></a>00378 
<a name="l00387"></a><a class="code" href="xml__parser__cosim_8h.html#aa853167eb50a80d4ede9780af353dd0e">00387</a> <a class="code" href="structType.html">Type</a>* <a class="code" href="xml__parser__cosim_8c.html#aa853167eb50a80d4ede9780af353dd0e" title="Get declared type of element.">getDeclaredType</a>(<a class="code" href="structModelDescription.html">ModelDescription</a>* md, <span class="keyword">const</span> <span class="keywordtype">char</span>* declaredType){
<a name="l00388"></a>00388     <span class="keywordtype">int</span> <a class="code" href="fmuTemplate_8h.html#ad51f78a2c68c740b5b1d4fa9bda8500f">i</a>;
<a name="l00389"></a>00389     <span class="keywordflow">if</span> (declaredType &amp;&amp; md-&gt;<a class="code" href="structModelDescription.html#a0408f6b6e30e0d722138a25297c01d03">typeDefinitions</a>)
<a name="l00390"></a>00390     <span class="keywordflow">for</span> (i=0; md-&gt;<a class="code" href="structModelDescription.html#a0408f6b6e30e0d722138a25297c01d03">typeDefinitions</a>[<a class="code" href="fmuTemplate_8h.html#ad51f78a2c68c740b5b1d4fa9bda8500f">i</a>]; i++){
<a name="l00391"></a>00391         <a class="code" href="structType.html">Type</a>* tp = (<a class="code" href="structType.html">Type</a>*)md-&gt;<a class="code" href="structModelDescription.html#a0408f6b6e30e0d722138a25297c01d03">typeDefinitions</a>[i];
<a name="l00392"></a>00392         if (!strcmp(declaredType, <a class="code" href="xml__parser__cosim_8c.html#ac5d9dc6a672aef4c044285da7b26f5a9" title="Get name.">getName</a>(tp))) <span class="keywordflow">return</span> tp;
<a name="l00393"></a>00393     }
<a name="l00394"></a>00394     <span class="keywordflow">return</span> NULL;
<a name="l00395"></a>00395 }
<a name="l00396"></a>00396 
<a name="l00397"></a>00397 <span class="comment">//Not used</span>
<a name="l00398"></a>00398 <span class="comment">/*const char* getString2(ModelDescription* md, void* tp, Att a) {</span>
<a name="l00399"></a>00399 <span class="comment">    Type* type;</span>
<a name="l00400"></a>00400 <span class="comment">    const char* value = getString(tp, a);</span>
<a name="l00401"></a>00401 <span class="comment">    if (value) return value; // found</span>
<a name="l00402"></a>00402 <span class="comment">    // search declared type, if any</span>
<a name="l00403"></a>00403 <span class="comment">    type = getDeclaredType(md, getString(tp, att_declaredType));</span>
<a name="l00404"></a>00404 <span class="comment">    return type ? getString(type-&gt;typeSpec, a) : NULL;</span>
<a name="l00405"></a>00405 <span class="comment">}*/</span>
<a name="l00406"></a>00406 
<a name="l00414"></a><a class="code" href="xml__parser__cosim_8h.html#a7987805e85fc264a7e13b5d70ef96bb3">00414</a> <span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="xml__parser__cosim_8c.html#a7987805e85fc264a7e13b5d70ef96bb3" title="Get description from variable or from declared type, or NULL.">getDescription</a>(<a class="code" href="structModelDescription.html">ModelDescription</a>* md, <a class="code" href="structScalarVariable.html">ScalarVariable</a>* sv) {
<a name="l00415"></a>00415     <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="expat_8h.html#a4a30a13b813682e68c5b689b45c65971">value</a> = <a class="code" href="xml__parser__cosim_8c.html#a4173c22c77f0b3fd0a756c939f018010" title="Get string.">getString</a>(sv, <a class="code" href="xml__parser__cosim_8h.html#a59159c2e4de0af530912e1e58c84bacfad9a4e672c549260e12b6dcd91bb83a0d">att_description</a>);
<a name="l00416"></a>00416     <a class="code" href="structType.html">Type</a>* type; 
<a name="l00417"></a>00417     <span class="keywordflow">if</span> (value) <span class="keywordflow">return</span> <a class="code" href="expat_8h.html#a4a30a13b813682e68c5b689b45c65971">value</a>; <span class="comment">// found</span>
<a name="l00418"></a>00418     <span class="comment">// search declared type, if any</span>
<a name="l00419"></a>00419     type = <a class="code" href="xml__parser__cosim_8c.html#aa853167eb50a80d4ede9780af353dd0e" title="Get declared type of element.">getDeclaredType</a>(md, <a class="code" href="xml__parser__cosim_8c.html#a4173c22c77f0b3fd0a756c939f018010" title="Get string.">getString</a>(sv-&gt;<a class="code" href="structScalarVariable.html#a3563abf1de77f1e99c86851aefaa7650">typeSpec</a>, <a class="code" href="xml__parser__cosim_8h.html#a59159c2e4de0af530912e1e58c84bacfa01402fb5e98c93dfefbe4e98ee496ed2">att_declaredType</a>));
<a name="l00420"></a>00420     <span class="keywordflow">return</span> type ? <a class="code" href="xml__parser__cosim_8c.html#a4173c22c77f0b3fd0a756c939f018010" title="Get string.">getString</a>(type, <a class="code" href="xml__parser__cosim_8h.html#a59159c2e4de0af530912e1e58c84bacfad9a4e672c549260e12b6dcd91bb83a0d">att_description</a>) : NULL;
<a name="l00421"></a>00421 }
<a name="l00422"></a>00422 
<a name="l00433"></a><a class="code" href="xml__parser__cosim_8h.html#a1196bb1915baac70a9ab35607bdb8b4f">00433</a> <span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="xml__parser__cosim_8c.html#a1196bb1915baac70a9ab35607bdb8b4f" title="Check the attribute defined by vr and type.">getVariableAttributeString</a>(<a class="code" href="structModelDescription.html">ModelDescription</a>* md, 
<a name="l00434"></a>00434         <a class="code" href="common_2fmiModelTypes_8h.html#a391754b90ab44cfcc77cd56acebeb657">fmiValueReference</a> vr, <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668f">Elm</a> type, <a class="code" href="xml__parser__cosim_8h.html#a59159c2e4de0af530912e1e58c84bacf">Att</a> a){
<a name="l00435"></a>00435     <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="expat_8h.html#a4a30a13b813682e68c5b689b45c65971">value</a>;
<a name="l00436"></a>00436     <span class="keyword">const</span> <span class="keywordtype">char</span>* declaredType;
<a name="l00437"></a>00437     <a class="code" href="structType.html">Type</a>* tp; 
<a name="l00438"></a>00438     <a class="code" href="structScalarVariable.html">ScalarVariable</a>* sv = <a class="code" href="xml__parser__cosim_8c.html#a15ff0a4f305bf3463b10901838ca7382" title="Get scalar variable.">getVariable</a>(md, vr, type);
<a name="l00439"></a>00439     <span class="keywordflow">if</span> (!sv) <span class="keywordflow">return</span> NULL;
<a name="l00440"></a>00440     value = <a class="code" href="xml__parser__cosim_8c.html#a4173c22c77f0b3fd0a756c939f018010" title="Get string.">getString</a>(sv-&gt;<a class="code" href="structScalarVariable.html#a3563abf1de77f1e99c86851aefaa7650">typeSpec</a>, a);
<a name="l00441"></a>00441     <span class="keywordflow">if</span> (value) <span class="keywordflow">return</span> <a class="code" href="expat_8h.html#a4a30a13b813682e68c5b689b45c65971">value</a>; <span class="comment">// found</span>
<a name="l00442"></a>00442     <span class="comment">// search declared type, if any</span>
<a name="l00443"></a>00443     tp = <a class="code" href="xml__parser__cosim_8c.html#aa853167eb50a80d4ede9780af353dd0e" title="Get declared type of element.">getDeclaredType</a>(md, <a class="code" href="xml__parser__cosim_8c.html#a4173c22c77f0b3fd0a756c939f018010" title="Get string.">getString</a>(sv-&gt;<a class="code" href="structScalarVariable.html#a3563abf1de77f1e99c86851aefaa7650">typeSpec</a>, <a class="code" href="xml__parser__cosim_8h.html#a59159c2e4de0af530912e1e58c84bacfa01402fb5e98c93dfefbe4e98ee496ed2">att_declaredType</a>));
<a name="l00444"></a>00444     <span class="keywordflow">return</span> tp ? <a class="code" href="xml__parser__cosim_8c.html#a4173c22c77f0b3fd0a756c939f018010" title="Get string.">getString</a>(tp-&gt;<a class="code" href="structType.html#a36ecb0b98e3bcc02efda901e36407d22">typeSpec</a>, a) : NULL;
<a name="l00445"></a>00445 }
<a name="l00446"></a>00446 
<a name="l00459"></a><a class="code" href="xml__parser__cosim_8h.html#a1f88d2f22b62b0684039d20e29bfa3ae">00459</a> <span class="keywordtype">double</span> <a class="code" href="xml__parser__cosim_8c.html#a1f88d2f22b62b0684039d20e29bfa3ae" title="Get attribute value from scalar variable given by vr and type, incude default value provided by decla...">getVariableAttributeDouble</a>(<a class="code" href="structModelDescription.html">ModelDescription</a>* md, 
<a name="l00460"></a>00460         <a class="code" href="common_2fmiModelTypes_8h.html#a391754b90ab44cfcc77cd56acebeb657">fmiValueReference</a> vr, <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668f">Elm</a> type, <a class="code" href="xml__parser__cosim_8h.html#a59159c2e4de0af530912e1e58c84bacf">Att</a> a, <a class="code" href="xml__parser__cosim_8h.html#a4cb71a221c69f3395d9fb2369cfb7e9b">ValueStatus</a>* vs){
<a name="l00461"></a>00461     <span class="keywordtype">double</span> d = 0;
<a name="l00462"></a>00462     <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="expat_8h.html#a4a30a13b813682e68c5b689b45c65971">value</a> = <a class="code" href="xml__parser__cosim_8c.html#a1196bb1915baac70a9ab35607bdb8b4f" title="Check the attribute defined by vr and type.">getVariableAttributeString</a>(md, vr, type, a);
<a name="l00463"></a>00463     <span class="keywordflow">if</span> (!value) { *vs = <a class="code" href="xml__parser__cosim_8h.html#a4cb71a221c69f3395d9fb2369cfb7e9ba944078a6b0de97769a56b385f56f9fcf">valueMissing</a>; <span class="keywordflow">return</span> d; }
<a name="l00464"></a>00464     *vs = (1==sscanf(value, <span class="stringliteral">&quot;%lf&quot;</span>, &amp;d)) ? <a class="code" href="xml__parser__cosim_8h.html#a4cb71a221c69f3395d9fb2369cfb7e9ba88b960faf03ff59bf315a2a7353aa1ed">valueDefined</a> : <a class="code" href="xml__parser__cosim_8h.html#a4cb71a221c69f3395d9fb2369cfb7e9bac98090842216cd0c09efc3ca8b1de6ad">valueIllegal</a>;
<a name="l00465"></a>00465     <span class="keywordflow">return</span> d;    
<a name="l00466"></a>00466 }
<a name="l00467"></a>00467 
<a name="l00475"></a><a class="code" href="xml__parser__cosim_8h.html#a7419af143a05d008f7560bbcb06d3d09">00475</a> <span class="keywordtype">double</span> <a class="code" href="xml__parser__cosim_8c.html#a7419af143a05d008f7560bbcb06d3d09" title="Get nominal value from real variable or its declared type.">getNominal</a>(<a class="code" href="structModelDescription.html">ModelDescription</a>* md, <a class="code" href="common_2fmiModelTypes_8h.html#a391754b90ab44cfcc77cd56acebeb657">fmiValueReference</a> vr){
<a name="l00476"></a>00476     <a class="code" href="xml__parser__cosim_8h.html#a4cb71a221c69f3395d9fb2369cfb7e9b">ValueStatus</a> vs;
<a name="l00477"></a>00477     <span class="keywordtype">double</span> nominal = <a class="code" href="xml__parser__cosim_8c.html#a1f88d2f22b62b0684039d20e29bfa3ae" title="Get attribute value from scalar variable given by vr and type, incude default value provided by decla...">getVariableAttributeDouble</a>(md, vr, <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fabb70f90bc7f0e801e505879c40002c9e">elm_Real</a>, <a class="code" href="xml__parser__cosim_8h.html#a59159c2e4de0af530912e1e58c84bacfa3cb09ef10deff02fcfe759dafc5916f9">att_nominal</a>, &amp;vs);
<a name="l00478"></a>00478     <span class="keywordflow">return</span> vs==<a class="code" href="xml__parser__cosim_8h.html#a4cb71a221c69f3395d9fb2369cfb7e9ba88b960faf03ff59bf315a2a7353aa1ed">valueDefined</a> ? nominal : 1.0;
<a name="l00479"></a>00479 }
<a name="l00480"></a>00480 
<a name="l00481"></a>00481 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="xml__parser__cosim_8c.html#a5c08b05ea59ce8512f3ff4e52b7d07d3" title="Print information for list of elements.">printList</a>(<span class="keywordtype">int</span> indent, <span class="keywordtype">void</span>** list);
<a name="l00482"></a>00482 
<a name="l00490"></a><a class="code" href="xml__parser__cosim_8c.html#a68ac634c587e1398100b92d34728b391">00490</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="xml__parser__cosim_8c.html#a68ac634c587e1398100b92d34728b391" title="Various checks that log an error and stop the parser.">checkPointer</a>(<span class="keyword">const</span> <span class="keywordtype">void</span>* ptr){
<a name="l00491"></a>00491     <span class="keywordflow">if</span> (! ptr) {
<a name="l00492"></a>00492         printf(<span class="stringliteral">&quot;Out of memory\n&quot;</span>);
<a name="l00493"></a>00493         <span class="keywordflow">if</span> (<a class="code" href="xml__parser__cosim_8c.html#ae610b1239dcb18c41bb131788ca4b520">parser</a>) <a class="code" href="expat_8h.html#a2ed188bab24ab1b97c8bc812d0e1de01">XML_StopParser</a>(<a class="code" href="xml__parser__cosim_8c.html#ae610b1239dcb18c41bb131788ca4b520">parser</a>, <a class="code" href="expat_8h.html#a10f4e50c3f8ef8a50f00110b0319b12a">XML_FALSE</a>);
<a name="l00494"></a>00494         <span class="keywordflow">return</span> 1; <span class="comment">// error </span>
<a name="l00495"></a>00495     }
<a name="l00496"></a>00496     <span class="keywordflow">return</span> 0; <span class="comment">// success</span>
<a name="l00497"></a>00497 }
<a name="l00498"></a>00498 
<a name="l00509"></a><a class="code" href="xml__parser__cosim_8c.html#aeffb629c56caee60ec6eaa181c6f781f">00509</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="xml__parser__cosim_8c.html#aeffb629c56caee60ec6eaa181c6f781f" title="Check if string name is in the string array array[].">checkName</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="expat_8h.html#a1b49b495b59f9e73205b69ad1a2965b0">name</a>, <span class="keyword">const</span> <span class="keywordtype">char</span>* kind, <span class="keyword">const</span> <span class="keywordtype">char</span>* array[], <span class="keywordtype">int</span> n){
<a name="l00510"></a>00510     <span class="keywordtype">int</span> <a class="code" href="fmuTemplate_8h.html#ad51f78a2c68c740b5b1d4fa9bda8500f">i</a>;
<a name="l00511"></a>00511     <span class="keywordflow">for</span> (i=0; i&lt;n; i++) {
<a name="l00512"></a>00512         <span class="keywordflow">if</span> (!strcmp(name, array[i])) <span class="keywordflow">return</span> <a class="code" href="fmuTemplate_8h.html#ad51f78a2c68c740b5b1d4fa9bda8500f">i</a>;
<a name="l00513"></a>00513     }
<a name="l00514"></a>00514     printf(<span class="stringliteral">&quot;Illegal %s %s\n&quot;</span>, kind, name);
<a name="l00515"></a>00515     <a class="code" href="expat_8h.html#a2ed188bab24ab1b97c8bc812d0e1de01">XML_StopParser</a>(<a class="code" href="xml__parser__cosim_8c.html#ae610b1239dcb18c41bb131788ca4b520">parser</a>, <a class="code" href="expat_8h.html#a10f4e50c3f8ef8a50f00110b0319b12a">XML_FALSE</a>);
<a name="l00516"></a>00516     <span class="keywordflow">return</span> -1;
<a name="l00517"></a>00517 }
<a name="l00518"></a>00518 
<a name="l00526"></a><a class="code" href="xml__parser__cosim_8c.html#a7e958e4d0913760c94e10050063e311f">00526</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="xml__parser__cosim_8c.html#a7e958e4d0913760c94e10050063e311f" title="Check the enum value of elm.">checkElement</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* elm){
<a name="l00527"></a>00527     <span class="keywordflow">return</span> <a class="code" href="xml__parser__cosim_8c.html#aeffb629c56caee60ec6eaa181c6f781f" title="Check if string name is in the string array array[].">checkName</a>(elm, <span class="stringliteral">&quot;element&quot;</span>, <a class="code" href="xml__parser__cosim_8c.html#a1dacbe49ed03276788f8f6352f8054c2">elmNames</a>, <a class="code" href="xml__parser__cosim_8h.html#aa05cf21f5703eadc6ad0ec00b7570235">SIZEOF_ELM</a>);
<a name="l00528"></a>00528 }
<a name="l00529"></a>00529 
<a name="l00537"></a><a class="code" href="xml__parser__cosim_8c.html#a2397475533f5272d45d431d006feed66">00537</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="xml__parser__cosim_8c.html#a2397475533f5272d45d431d006feed66" title="Check the enum value of an attribute.">checkAttribute</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* att){
<a name="l00538"></a>00538     <span class="keywordflow">return</span> <a class="code" href="xml__parser__cosim_8c.html#aeffb629c56caee60ec6eaa181c6f781f" title="Check if string name is in the string array array[].">checkName</a>(att, <span class="stringliteral">&quot;attribute&quot;</span>, <a class="code" href="xml__parser__cosim_8c.html#ad43413b3e633885aeb1fafea5deb5d57">attNames</a>, <a class="code" href="xml__parser__cosim_8h.html#a190c4e51780576d19b61259e5d8e3126">SIZEOF_ATT</a>);
<a name="l00539"></a>00539 }
<a name="l00540"></a>00540 
<a name="l00548"></a><a class="code" href="xml__parser__cosim_8c.html#a53596f97ec1e04d04bc7a6eac85d9381">00548</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="xml__parser__cosim_8c.html#a53596f97ec1e04d04bc7a6eac85d9381" title="Check enum value of input string enu.">checkEnumValue</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* enu){
<a name="l00549"></a>00549     <span class="keywordflow">return</span> <a class="code" href="xml__parser__cosim_8c.html#aeffb629c56caee60ec6eaa181c6f781f" title="Check if string name is in the string array array[].">checkName</a>(enu, <span class="stringliteral">&quot;enum value&quot;</span>, <a class="code" href="xml__parser__cosim_8c.html#a5f179c5f60739cb1e097c4dba1e6c20a">enuNames</a>, <a class="code" href="xml__parser__cosim_8h.html#a94e7acac9ae1c29c86bd5c1a19718de1">SIZEOF_ENU</a>);
<a name="l00550"></a>00550 }
<a name="l00551"></a>00551 
<a name="l00558"></a><a class="code" href="xml__parser__cosim_8c.html#aa6201ba845a856a23d8429c51e2a16cb">00558</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="xml__parser__cosim_8c.html#aa6201ba845a856a23d8429c51e2a16cb" title="Print the error information for wrong type.">logFatalTypeError</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* expected, <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668f">Elm</a> found) {
<a name="l00559"></a>00559     printf(<span class="stringliteral">&quot;Wrong element type, expected %s, found %s\n&quot;</span>, 
<a name="l00560"></a>00560             expected, <a class="code" href="xml__parser__cosim_8c.html#a1dacbe49ed03276788f8f6352f8054c2">elmNames</a>[found]);
<a name="l00561"></a>00561     <a class="code" href="expat_8h.html#a2ed188bab24ab1b97c8bc812d0e1de01">XML_StopParser</a>(<a class="code" href="xml__parser__cosim_8c.html#ae610b1239dcb18c41bb131788ca4b520">parser</a>, <a class="code" href="expat_8h.html#a10f4e50c3f8ef8a50f00110b0319b12a">XML_FALSE</a>);
<a name="l00562"></a>00562 }
<a name="l00563"></a>00563 
<a name="l00571"></a><a class="code" href="xml__parser__cosim_8c.html#affc6288ba88dc03abe7b6ee1cf2289cb">00571</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="xml__parser__cosim_8c.html#affc6288ba88dc03abe7b6ee1cf2289cb" title="Verify that element is of the given type.">checkElementType</a>(<span class="keywordtype">void</span>* element, <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668f">Elm</a> e) {
<a name="l00572"></a>00572     <a class="code" href="structElement.html">Element</a>* elm = (<a class="code" href="structElement.html">Element</a>* )element;
<a name="l00573"></a>00573     <span class="keywordflow">if</span> (elm-&gt;<a class="code" href="structElement.html#a7b29ec1313f99517acb89211871fdd34">type</a> == e) <span class="keywordflow">return</span> 0; <span class="comment">// success</span>
<a name="l00574"></a>00574     <a class="code" href="xml__parser__cosim_8c.html#aa6201ba845a856a23d8429c51e2a16cb" title="Print the error information for wrong type.">logFatalTypeError</a>(<a class="code" href="xml__parser__cosim_8c.html#a1dacbe49ed03276788f8f6352f8054c2">elmNames</a>[e], elm-&gt;<a class="code" href="structElement.html#a7b29ec1313f99517acb89211871fdd34">type</a>);
<a name="l00575"></a>00575     <span class="keywordflow">return</span> 1; <span class="comment">// error    </span>
<a name="l00576"></a>00576 }
<a name="l00577"></a>00577 
<a name="l00585"></a><a class="code" href="xml__parser__cosim_8c.html#ae2170a70f8db7fd68d9ebd3c424db511">00585</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="xml__parser__cosim_8c.html#ae2170a70f8db7fd68d9ebd3c424db511" title="Verify that the next stack element exists and is of the given type.">checkPeek</a>(<a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668f">Elm</a> e) {
<a name="l00586"></a>00586     <span class="keywordflow">if</span> (<a class="code" href="stack_8c.html#ad2cd82544211c293edc1e540475673eb">stackIsEmpty</a>(stack)){
<a name="l00587"></a>00587         printf(<span class="stringliteral">&quot;Illegal document structure, expected %s\n&quot;</span>, <a class="code" href="xml__parser__cosim_8c.html#a1dacbe49ed03276788f8f6352f8054c2">elmNames</a>[e]);
<a name="l00588"></a>00588         <a class="code" href="expat_8h.html#a2ed188bab24ab1b97c8bc812d0e1de01">XML_StopParser</a>(<a class="code" href="xml__parser__cosim_8c.html#ae610b1239dcb18c41bb131788ca4b520">parser</a>, <a class="code" href="expat_8h.html#a10f4e50c3f8ef8a50f00110b0319b12a">XML_FALSE</a>);
<a name="l00589"></a>00589         <span class="keywordflow">return</span> 1; <span class="comment">// error</span>
<a name="l00590"></a>00590     }
<a name="l00591"></a>00591     <span class="keywordflow">return</span> e==<a class="code" href="xml__parser__cosim_8c.html#ad11a2f38dcbf340c673b6a9b09ed7185">ANY_TYPE</a> ? 0 : <a class="code" href="xml__parser__cosim_8c.html#affc6288ba88dc03abe7b6ee1cf2289cb" title="Verify that element is of the given type.">checkElementType</a>(<a class="code" href="stack_8c.html#ab45ab798c968da8e09ea1c8051c4dea9">stackPeek</a>(stack), e); <span class="comment">//stackPeek() retrieves item at top of stack</span>
<a name="l00592"></a>00592 }
<a name="l00593"></a>00593 
<a name="l00601"></a><a class="code" href="xml__parser__cosim_8c.html#a8fbde91f0009784906405f7130d96739">00601</a> <span class="keyword">static</span> <span class="keywordtype">void</span>* <a class="code" href="xml__parser__cosim_8c.html#a8fbde91f0009784906405f7130d96739" title="Get the next stack element of the given type.">checkPop</a>(<a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668f">Elm</a> e){
<a name="l00602"></a>00602     <span class="keywordflow">return</span> <a class="code" href="xml__parser__cosim_8c.html#ae2170a70f8db7fd68d9ebd3c424db511" title="Verify that the next stack element exists and is of the given type.">checkPeek</a>(e) ?  NULL : <a class="code" href="stack_8c.html#a9842be4ad74e7117c9fb021d46c6a6a7">stackPop</a>(stack);     <span class="comment">// stackPop() removes most recently added item</span>
<a name="l00603"></a>00603 }
<a name="l00604"></a>00604 
<a name="l00611"></a><a class="code" href="xml__parser__cosim_8c.html#ad1a30703c17843827888269abe029299">00611</a> <a class="code" href="xml__parser__cosim_8h.html#a1e0354e1cfa4d729a8b30688d18256fd">AstNodeType</a> <a class="code" href="xml__parser__cosim_8c.html#ad1a30703c17843827888269abe029299" title="Get AST node type.">getAstNodeType</a>(<a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668f">Elm</a> e){
<a name="l00612"></a>00612   <span class="comment">//printf(&quot;  -&gt; getting ASTNode Type for %s\n&quot;, elmNames[e]);</span>
<a name="l00613"></a>00613     <span class="keywordflow">switch</span> (e) {
<a name="l00614"></a>00614     <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fae945b5751da1f7d2e66a8af994698eb0">elm_fmiModelDescription</a>: 
<a name="l00615"></a>00615         <span class="keywordflow">return</span> <a class="code" href="xml__parser__cosim_8h.html#a1e0354e1cfa4d729a8b30688d18256fdacdf46b059af7e2210dd6d5af340d7b17">astModelDescription</a>;
<a name="l00616"></a>00616     <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa03d82d44c20820f083cd5749f525156b">elm_Type</a>:
<a name="l00617"></a>00617         <span class="keywordflow">return</span> <a class="code" href="xml__parser__cosim_8h.html#a1e0354e1cfa4d729a8b30688d18256fda43c9857656d7e3bc7f69e4d7f3bb0f41">astType</a>;
<a name="l00618"></a>00618     <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa839bc3580841101552970a9a3857134b">elm_ScalarVariable</a>:
<a name="l00619"></a>00619         <span class="keywordflow">return</span> <a class="code" href="xml__parser__cosim_8h.html#a1e0354e1cfa4d729a8b30688d18256fda45324db20815b75eebd19f24122de91a">astScalarVariable</a>;
<a name="l00620"></a>00620     <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa03df9dd2c5b4b5e3a94d2617a968c200">elm_Implementation</a>:            <span class="comment">// Add Implementation</span>
<a name="l00621"></a>00621     <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668faf9efccd479ea377955494e55fe91cc96">elm_BaseUnit</a>:
<a name="l00622"></a>00622     <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa6f7382ea290d808b06076a0720c6fb48">elm_EnumerationType</a>:
<a name="l00623"></a>00623     <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa5c688a86933559f64f014b1835c5679c">elm_Tool</a>:
<a name="l00624"></a>00624     <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa69dd315a1b8dad521d323967b7bb5457">elm_UnitDefinitions</a>:
<a name="l00625"></a>00625     <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fab7c46c3aad226c6ac4e2772b6eed8e30">elm_TypeDefinitions</a>:
<a name="l00626"></a>00626     <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa7e38ebbd4fe0a2181c077516ba80d34d">elm_VendorAnnotations</a>:
<a name="l00627"></a>00627     <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa9f2d508373be462de014ebb0d7fd8c23">elm_ModelVariables</a>:
<a name="l00628"></a>00628     <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa86046f467a534d5f37c5cc86e8eeb246">elm_DirectDependency</a>:
<a name="l00629"></a>00629     <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fae687fdb02391a2f8d37faf3a8aacc434">elm_CoSimulation_StandAlone</a>:   <span class="comment">// Add CoSimulation_StandAlone</span>
<a name="l00630"></a>00630     <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa8d73349bb01255abd227a3cbf91da37e">elm_CoSimulation_Tool</a>:         <span class="comment">// Add CoSimulaiton_Tool</span>
<a name="l00631"></a>00631         <span class="keywordflow">return</span> <a class="code" href="xml__parser__cosim_8h.html#a1e0354e1cfa4d729a8b30688d18256fda7182392768c00d0cdf9748030778b6b6">astListElement</a>;
<a name="l00632"></a>00632     <span class="keywordflow">default</span>:
<a name="l00633"></a>00633         <span class="keywordflow">return</span> <a class="code" href="xml__parser__cosim_8h.html#a1e0354e1cfa4d729a8b30688d18256fda99ad3c1adf1417b269f139519c1951ee">astElement</a>; 
<a name="l00634"></a>00634     }
<a name="l00635"></a>00635 }
<a name="l00636"></a>00636 
<a name="l00647"></a><a class="code" href="xml__parser__cosim_8c.html#af367c91613ef9ba1a9b5aea9d57601a3">00647</a> <span class="keywordtype">int</span> <a class="code" href="xml__parser__cosim_8c.html#af367c91613ef9ba1a9b5aea9d57601a3" title="Add Attributes to an given element.">addAttributes</a>(<a class="code" href="structElement.html">Element</a>* el, <span class="keyword">const</span> <span class="keywordtype">char</span>** attr) {
<a name="l00648"></a>00648     <span class="keywordtype">int</span> n, a;
<a name="l00649"></a>00649     <span class="keyword">const</span> <span class="keywordtype">char</span>** att = NULL;
<a name="l00650"></a>00650     <span class="keywordflow">for</span> (n=0; attr[n]; n+=2);
<a name="l00651"></a>00651     <span class="keywordflow">if</span> (n&gt;0) {
<a name="l00652"></a>00652         att = calloc(n, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>*));
<a name="l00653"></a>00653         <span class="keywordflow">if</span> (<a class="code" href="xml__parser__cosim_8c.html#a68ac634c587e1398100b92d34728b391" title="Various checks that log an error and stop the parser.">checkPointer</a>(att)) <span class="keywordflow">return</span> 1;
<a name="l00654"></a>00654     } 
<a name="l00655"></a>00655     <span class="keywordflow">for</span> (n=0; attr[n]; n+=2) {
<a name="l00656"></a>00656         <span class="keywordtype">char</span>* <a class="code" href="expat_8h.html#a4a30a13b813682e68c5b689b45c65971">value</a> = strdup(attr[n+1]);
<a name="l00657"></a>00657         <span class="keywordflow">if</span> (<a class="code" href="xml__parser__cosim_8c.html#a68ac634c587e1398100b92d34728b391" title="Various checks that log an error and stop the parser.">checkPointer</a>(value)) <span class="keywordflow">return</span> 1;
<a name="l00658"></a>00658         a = <a class="code" href="xml__parser__cosim_8c.html#a2397475533f5272d45d431d006feed66" title="Check the enum value of an attribute.">checkAttribute</a>(attr[n]);
<a name="l00659"></a>00659         <span class="keywordflow">if</span> (a == -1) <span class="keywordflow">return</span> 0;  <span class="comment">// illegal attribute error</span>
<a name="l00660"></a>00660         att[n  ] = <a class="code" href="xml__parser__cosim_8c.html#ad43413b3e633885aeb1fafea5deb5d57">attNames</a>[a]; <span class="comment">// no heap memory</span>
<a name="l00661"></a>00661         att[n+1] = <a class="code" href="expat_8h.html#a4a30a13b813682e68c5b689b45c65971">value</a>;       <span class="comment">// heap memory</span>
<a name="l00662"></a>00662     }
<a name="l00663"></a>00663     el-&gt;<a class="code" href="structElement.html#aaebbd64792617c5e74c37669a8e17795">attributes</a> = att; <span class="comment">// NULL if n=0</span>
<a name="l00664"></a>00664     el-&gt;<a class="code" href="structElement.html#a53875a4f352401abdf5605c29b45e9ad">n</a> = n;
<a name="l00665"></a>00665     <span class="keywordflow">return</span> 0; <span class="comment">// success</span>
<a name="l00666"></a>00666 }
<a name="l00667"></a>00667 
<a name="l00677"></a><a class="code" href="xml__parser__cosim_8c.html#a430a61c0b7ab42f57dfe8106d13e7467">00677</a> <a class="code" href="structElement.html">Element</a>* <a class="code" href="xml__parser__cosim_8c.html#a430a61c0b7ab42f57dfe8106d13e7467" title="Add an new element.">newElement</a>(<a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668f">Elm</a> type, <span class="keywordtype">int</span> size, <span class="keyword">const</span> <span class="keywordtype">char</span>** attr) {
<a name="l00678"></a>00678     <a class="code" href="structElement.html">Element</a>* e = (<a class="code" href="structElement.html">Element</a>*)calloc(1, size);
<a name="l00679"></a>00679     <span class="keywordflow">if</span> (<a class="code" href="xml__parser__cosim_8c.html#a68ac634c587e1398100b92d34728b391" title="Various checks that log an error and stop the parser.">checkPointer</a>(e)) <span class="keywordflow">return</span> NULL; 
<a name="l00680"></a>00680     e-&gt;<a class="code" href="structElement.html#a7b29ec1313f99517acb89211871fdd34">type</a> = type;
<a name="l00681"></a>00681     e-&gt;<a class="code" href="structElement.html#aaebbd64792617c5e74c37669a8e17795">attributes</a> = NULL;
<a name="l00682"></a>00682     e-&gt;<a class="code" href="structElement.html#a53875a4f352401abdf5605c29b45e9ad">n</a>=0;
<a name="l00683"></a>00683     <span class="keywordflow">if</span> (<a class="code" href="xml__parser__cosim_8c.html#af367c91613ef9ba1a9b5aea9d57601a3" title="Add Attributes to an given element.">addAttributes</a>(e, attr)) <span class="keywordflow">return</span> NULL;
<a name="l00684"></a>00684 
<a name="l00685"></a>00685     <span class="keywordflow">return</span> e;
<a name="l00686"></a>00686 }
<a name="l00687"></a>00687 
<a name="l00696"></a><a class="code" href="xml__parser__cosim_8c.html#a5ffcddbdfcedd3ce33f9ec157b32cd4b">00696</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="expat__external_8h.html#aad85d290912c3ffed7a2ec0b6173dad3">XMLCALL</a> <a class="code" href="xml__parser__cosim_8c.html#a5ffcddbdfcedd3ce33f9ec157b32cd4b" title="Callback functions called by the XML parser.">startElement</a>(<span class="keywordtype">void</span> *<a class="code" href="expat_8h.html#afe0934df1732463fe5378d8c8724edc6">context</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *elm, <span class="keyword">const</span> <span class="keywordtype">char</span> **attr) {
<a name="l00697"></a>00697     <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668f">Elm</a> el;
<a name="l00698"></a>00698     <span class="keywordtype">void</span>* e;
<a name="l00699"></a>00699     <span class="keywordtype">int</span> size;
<a name="l00700"></a>00700     el = <a class="code" href="xml__parser__cosim_8c.html#a7e958e4d0913760c94e10050063e311f" title="Check the enum value of elm.">checkElement</a>(elm);  <span class="comment">//Get the index of element</span>
<a name="l00701"></a>00701     <a class="code" href="util_8c.html#a97697166f12dcd5e6fb5651ed7f1031a" title="Print debug message.">printDebug</a>(<span class="stringliteral">&quot;startElement()\n&quot;</span>);
<a name="l00702"></a>00702     <a class="code" href="util_8c.html#a4700e62a1aa5ee5174ebf6e6aaa1bf4d" title="Print formatted debug message.">printfDebug</a>(<span class="stringliteral">&quot;*** starting element %s\n&quot;</span>, <a class="code" href="xml__parser__cosim_8c.html#a1dacbe49ed03276788f8f6352f8054c2">elmNames</a>[el]);
<a name="l00703"></a>00703     <span class="keywordflow">if</span> (el==-1) <span class="keywordflow">return</span>; <span class="comment">// error</span>
<a name="l00704"></a>00704     <a class="code" href="xml__parser__cosim_8c.html#ac957c246a7bf701c778beba4fb6b0e14">skipData</a> = (el != <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa3ccaf33a433f3f7765ae2c0eb6f293df">elm_Name</a>); <span class="comment">// skip element content for all elements but Name</span>
<a name="l00705"></a>00705 
<a name="l00706"></a>00706     <span class="keywordflow">switch</span>(<a class="code" href="xml__parser__cosim_8c.html#ad1a30703c17843827888269abe029299" title="Get AST node type.">getAstNodeType</a>(el)){
<a name="l00707"></a>00707         <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a1e0354e1cfa4d729a8b30688d18256fda99ad3c1adf1417b269f139519c1951ee">astElement</a>:          size = <span class="keyword">sizeof</span>(<a class="code" href="structElement.html">Element</a>); <span class="keywordflow">break</span>;
<a name="l00708"></a>00708         <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a1e0354e1cfa4d729a8b30688d18256fda7182392768c00d0cdf9748030778b6b6">astListElement</a>:      size = <span class="keyword">sizeof</span>(<a class="code" href="structListElement.html">ListElement</a>); <span class="keywordflow">break</span>;
<a name="l00709"></a>00709         <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a1e0354e1cfa4d729a8b30688d18256fda43c9857656d7e3bc7f69e4d7f3bb0f41">astType</a>:             size = <span class="keyword">sizeof</span>(<a class="code" href="structType.html">Type</a>); <span class="keywordflow">break</span>;
<a name="l00710"></a>00710         <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a1e0354e1cfa4d729a8b30688d18256fda45324db20815b75eebd19f24122de91a">astScalarVariable</a>:   size = <span class="keyword">sizeof</span>(<a class="code" href="structScalarVariable.html">ScalarVariable</a>); <span class="keywordflow">break</span>;
<a name="l00711"></a>00711         <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a1e0354e1cfa4d729a8b30688d18256fdacdf46b059af7e2210dd6d5af340d7b17">astModelDescription</a>: size = <span class="keyword">sizeof</span>(<a class="code" href="structModelDescription.html">ModelDescription</a>); <span class="keywordflow">break</span>;
<a name="l00712"></a>00712         <span class="keywordflow">default</span>: assert(0);  <span class="comment">// Error message if there is no matching element,</span>
<a name="l00713"></a>00713     }
<a name="l00714"></a>00714     e = <a class="code" href="xml__parser__cosim_8c.html#a430a61c0b7ab42f57dfe8106d13e7467" title="Add an new element.">newElement</a>(el, size, attr);  <span class="comment">// Create a new element</span>
<a name="l00715"></a>00715     
<a name="l00716"></a>00716     <span class="keywordflow">if</span>(<a class="code" href="xml__parser__cosim_8c.html#a68ac634c587e1398100b92d34728b391" title="Various checks that log an error and stop the parser.">checkPointer</a>(e)) assert(0); <span class="comment">// Check the validity of the new element</span>
<a name="l00717"></a>00717     <a class="code" href="stack_8c.html#ab45552969418d7745f0faff4e5854547">stackPush</a>(stack, e); <span class="comment">// Add the element to stack and grow the stack if necessary</span>
<a name="l00718"></a>00718 }
<a name="l00719"></a>00719 
<a name="l00726"></a><a class="code" href="xml__parser__cosim_8c.html#a8e4972c1fe738628f1021ebce255b673">00726</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="xml__parser__cosim_8c.html#a8e4972c1fe738628f1021ebce255b673" title="Pop all elements of the given type from stack and add it to the ListElement that follows.">popList</a>(<a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668f">Elm</a> e) {
<a name="l00727"></a>00727     <span class="keywordtype">int</span> n = 0;
<a name="l00728"></a>00728     <a class="code" href="structElement.html">Element</a>** array;
<a name="l00729"></a>00729     <a class="code" href="structElement.html">Element</a>* elm = <a class="code" href="stack_8c.html#a9842be4ad74e7117c9fb021d46c6a6a7">stackPop</a>(stack);
<a name="l00730"></a>00730     <span class="keywordflow">while</span> (elm-&gt;<a class="code" href="structElement.html#a7b29ec1313f99517acb89211871fdd34">type</a> == e) {
<a name="l00731"></a>00731         elm = <a class="code" href="stack_8c.html#a9842be4ad74e7117c9fb021d46c6a6a7">stackPop</a>(stack);
<a name="l00732"></a>00732         n++;
<a name="l00733"></a>00733     }
<a name="l00734"></a>00734     <a class="code" href="stack_8c.html#ab45552969418d7745f0faff4e5854547">stackPush</a>(stack, elm); <span class="comment">// push ListElement into stack</span>
<a name="l00735"></a>00735     array = (<a class="code" href="structElement.html">Element</a>**)<a class="code" href="stack_8c.html#ab307ad6223a41d9cfd942333f2d3f239">stackLastPopedAsArray0</a>(stack, n); <span class="comment">// NULL terminated list</span>
<a name="l00736"></a>00736     <span class="keywordflow">if</span> (<a class="code" href="xml__parser__cosim_8c.html#ad1a30703c17843827888269abe029299" title="Get AST node type.">getAstNodeType</a>(elm-&gt;<a class="code" href="structElement.html#a7b29ec1313f99517acb89211871fdd34">type</a>)!=<a class="code" href="xml__parser__cosim_8h.html#a1e0354e1cfa4d729a8b30688d18256fda7182392768c00d0cdf9748030778b6b6">astListElement</a>) <span class="keywordflow">return</span>; <span class="comment">// failure</span>
<a name="l00737"></a>00737     ((<a class="code" href="structListElement.html">ListElement</a>*)elm)-&gt;list = array;
<a name="l00738"></a>00738     <span class="keywordflow">return</span>; <span class="comment">// success only if list!=NULL    </span>
<a name="l00739"></a>00739 }
<a name="l00740"></a>00740 
<a name="l00748"></a><a class="code" href="xml__parser__cosim_8c.html#abccdfade4523600bb2c0f5e7dadfd72a">00748</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="expat__external_8h.html#aad85d290912c3ffed7a2ec0b6173dad3">XMLCALL</a> <a class="code" href="xml__parser__cosim_8c.html#abccdfade4523600bb2c0f5e7dadfd72a" title="Pop the children from the stack and check for correct type and sequence of children This is the end h...">endElement</a>(<span class="keywordtype">void</span> *<a class="code" href="expat_8h.html#afe0934df1732463fe5378d8c8724edc6">context</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *elm) {
<a name="l00749"></a>00749     <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668f">Elm</a> el;
<a name="l00750"></a>00750     el = <a class="code" href="xml__parser__cosim_8c.html#a7e958e4d0913760c94e10050063e311f" title="Check the enum value of elm.">checkElement</a>(elm);
<a name="l00751"></a>00751     <a class="code" href="util_8c.html#a4700e62a1aa5ee5174ebf6e6aaa1bf4d" title="Print formatted debug message.">printfDebug</a>(<span class="stringliteral">&quot; **** ending element %s.\n&quot;</span>, <a class="code" href="xml__parser__cosim_8c.html#a1dacbe49ed03276788f8f6352f8054c2">elmNames</a>[el]);
<a name="l00752"></a>00752     <span class="keywordflow">switch</span>(el) {        
<a name="l00753"></a>00753         <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fae945b5751da1f7d2e66a8af994698eb0">elm_fmiModelDescription</a>: 
<a name="l00754"></a>00754             {
<a name="l00755"></a>00755                  <a class="code" href="structModelDescription.html">ModelDescription</a>* md;
<a name="l00756"></a>00756                  <a class="code" href="structListElement.html">ListElement</a>** im = NULL;       <span class="comment">//  NULL or list of CoSimulation_StandAlone under Implementation</span>
<a name="l00757"></a>00757                  <a class="code" href="structListElement.html">ListElement</a>** ud = NULL;       <span class="comment">//  NULL or list of BaseUnits under UnitDefinitions</span>
<a name="l00758"></a>00758                  <a class="code" href="structType.html">Type</a>**        td = NULL;       <span class="comment">//  NULL or list of Types under TypeDefinitions</span>
<a name="l00759"></a>00759                  <a class="code" href="structElement.html">Element</a>*      de = NULL;       <span class="comment">// NULL or DefaultExperiment</span>
<a name="l00760"></a>00760                  <a class="code" href="structListElement.html">ListElement</a>** va = NULL;       <span class="comment">// NULL or list of Tools</span>
<a name="l00761"></a>00761                  <a class="code" href="structScalarVariable.html">ScalarVariable</a>** mv = NULL;    <span class="comment">// NULL or list of ScalarVariables under ModelVariables</span>
<a name="l00762"></a>00762                  <a class="code" href="structListElement.html">ListElement</a>* child;
<a name="l00763"></a>00763                  <a class="code" href="util_8c.html#a97697166f12dcd5e6fb5651ed7f1031a" title="Print debug message.">printDebug</a>(<span class="stringliteral">&quot;$$$$$ entered endElement &#39;elm_fmiModelDescription&#39;\n&quot;</span>);
<a name="l00764"></a>00764                  child = <a class="code" href="xml__parser__cosim_8c.html#a8fbde91f0009784906405f7130d96739" title="Get the next stack element of the given type.">checkPop</a>(<a class="code" href="xml__parser__cosim_8c.html#ad11a2f38dcbf340c673b6a9b09ed7185">ANY_TYPE</a>); <span class="comment">// get a child from stack</span>
<a name="l00765"></a>00765 
<a name="l00766"></a>00766                  <span class="keywordflow">while</span> (child &amp;&amp; child-&gt;<a class="code" href="structListElement.html#a5256563c55b4e5cc1237cdef747fec82">type</a> != <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fae945b5751da1f7d2e66a8af994698eb0">elm_fmiModelDescription</a>)  <span class="comment">// add while-loop in case the elements in the random order</span>
<a name="l00767"></a>00767                  {
<a name="l00768"></a>00768                      <span class="keywordflow">if</span> (child-&gt;<a class="code" href="structListElement.html#a5256563c55b4e5cc1237cdef747fec82">type</a> == <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa7e38ebbd4fe0a2181c077516ba80d34d">elm_VendorAnnotations</a>){
<a name="l00769"></a>00769                          va = (<a class="code" href="structListElement.html">ListElement</a>**)child-&gt;<a class="code" href="structListElement.html#a9f3c565b2d55ac2d032b6c79091bfdf8">list</a>;    <span class="comment">// VendorAnnotations (ListElement) contains Tool (ListElement))</span>
<a name="l00770"></a>00770                          free(child);
<a name="l00771"></a>00771                          child = <a class="code" href="xml__parser__cosim_8c.html#a8fbde91f0009784906405f7130d96739" title="Get the next stack element of the given type.">checkPop</a>(<a class="code" href="xml__parser__cosim_8c.html#ad11a2f38dcbf340c673b6a9b09ed7185">ANY_TYPE</a>);
<a name="l00772"></a>00772                          <span class="keywordflow">if</span> (!child) <span class="keywordflow">return</span>;
<a name="l00773"></a>00773                      }
<a name="l00774"></a>00774                      <span class="keywordflow">if</span> (child-&gt;<a class="code" href="structListElement.html#a5256563c55b4e5cc1237cdef747fec82">type</a> == <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa6b6249ca9b42952a680d2d0118fecc5b">elm_DefaultExperiment</a>){
<a name="l00775"></a>00775                          de = (<a class="code" href="structElement.html">Element</a>*)child;              <span class="comment">// DefaultExperiment (Element) with only attributes</span>
<a name="l00776"></a>00776                          child = <a class="code" href="xml__parser__cosim_8c.html#a8fbde91f0009784906405f7130d96739" title="Get the next stack element of the given type.">checkPop</a>(<a class="code" href="xml__parser__cosim_8c.html#ad11a2f38dcbf340c673b6a9b09ed7185">ANY_TYPE</a>);
<a name="l00777"></a>00777                          <span class="keywordflow">if</span> (!child) <span class="keywordflow">return</span>;
<a name="l00778"></a>00778                      }
<a name="l00779"></a>00779                      <span class="keywordflow">if</span> (child-&gt;<a class="code" href="structListElement.html#a5256563c55b4e5cc1237cdef747fec82">type</a> == <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fab7c46c3aad226c6ac4e2772b6eed8e30">elm_TypeDefinitions</a>){
<a name="l00780"></a>00780                          td = (<a class="code" href="structType.html">Type</a>**)child-&gt;<a class="code" href="structListElement.html#a9f3c565b2d55ac2d032b6c79091bfdf8">list</a>;          <span class="comment">// TypeDefinitions (ListElement) contains Type (Type)</span>
<a name="l00781"></a>00781                          free(child);
<a name="l00782"></a>00782                          child = <a class="code" href="xml__parser__cosim_8c.html#a8fbde91f0009784906405f7130d96739" title="Get the next stack element of the given type.">checkPop</a>(<a class="code" href="xml__parser__cosim_8c.html#ad11a2f38dcbf340c673b6a9b09ed7185">ANY_TYPE</a>);
<a name="l00783"></a>00783                          <span class="keywordflow">if</span> (!child) <span class="keywordflow">return</span>;
<a name="l00784"></a>00784                      }
<a name="l00785"></a>00785                      <span class="keywordflow">if</span> (child-&gt;<a class="code" href="structListElement.html#a5256563c55b4e5cc1237cdef747fec82">type</a> == <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa69dd315a1b8dad521d323967b7bb5457">elm_UnitDefinitions</a>){
<a name="l00786"></a>00786                          ud = (<a class="code" href="structListElement.html">ListElement</a>**)child-&gt;<a class="code" href="structListElement.html#a9f3c565b2d55ac2d032b6c79091bfdf8">list</a>;   <span class="comment">// UnitDefinitions (ListElement) contains BaseUnit (ListElement)</span>
<a name="l00787"></a>00787                          free(child);
<a name="l00788"></a>00788                          child = <a class="code" href="xml__parser__cosim_8c.html#a8fbde91f0009784906405f7130d96739" title="Get the next stack element of the given type.">checkPop</a>(<a class="code" href="xml__parser__cosim_8c.html#ad11a2f38dcbf340c673b6a9b09ed7185">ANY_TYPE</a>);
<a name="l00789"></a>00789                          <span class="keywordflow">if</span> (!child) <span class="keywordflow">return</span>;
<a name="l00790"></a>00790                      }
<a name="l00791"></a>00791                      <span class="keywordflow">if</span> (child-&gt;<a class="code" href="structListElement.html#a5256563c55b4e5cc1237cdef747fec82">type</a> == <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa03df9dd2c5b4b5e3a94d2617a968c200">elm_Implementation</a>){    <span class="comment">// Implementation is listElement, it can be treated the same as UnitDefinitions</span>
<a name="l00792"></a>00792                          im = (<a class="code" href="structListElement.html">ListElement</a>**)child-&gt;<a class="code" href="structListElement.html#a9f3c565b2d55ac2d032b6c79091bfdf8">list</a>;       <span class="comment">// Implementation (Implementation) contains CoSimulation_StandAlone (ListElement)</span>
<a name="l00793"></a>00793                          free(child);                           <span class="comment">// Zuo:</span>
<a name="l00794"></a>00794                          child = <a class="code" href="xml__parser__cosim_8c.html#a8fbde91f0009784906405f7130d96739" title="Get the next stack element of the given type.">checkPop</a>(<a class="code" href="xml__parser__cosim_8c.html#ad11a2f38dcbf340c673b6a9b09ed7185">ANY_TYPE</a>);            <span class="comment">// Zuo:</span>
<a name="l00795"></a>00795                          <span class="keywordflow">if</span> (!child) <span class="keywordflow">return</span>;                    <span class="comment">// Zuo:</span>
<a name="l00796"></a>00796                      }                                          <span class="comment">// Zuo:</span>
<a name="l00797"></a>00797                      <span class="keywordflow">if</span> (child-&gt;<a class="code" href="structListElement.html#a5256563c55b4e5cc1237cdef747fec82">type</a> == <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa9f2d508373be462de014ebb0d7fd8c23">elm_ModelVariables</a>){
<a name="l00798"></a>00798                           mv = (<a class="code" href="structScalarVariable.html">ScalarVariable</a>**)child-&gt;<a class="code" href="structListElement.html#a9f3c565b2d55ac2d032b6c79091bfdf8">list</a>;  <span class="comment">// ModelVariables (ListElement) contains ScalarVariable (ScalarVariable)</span>
<a name="l00799"></a>00799                           free(child);
<a name="l00800"></a>00800                           child = <a class="code" href="xml__parser__cosim_8c.html#a8fbde91f0009784906405f7130d96739" title="Get the next stack element of the given type.">checkPop</a>(<a class="code" href="xml__parser__cosim_8c.html#ad11a2f38dcbf340c673b6a9b09ed7185">ANY_TYPE</a>);
<a name="l00801"></a>00801                           <span class="keywordflow">if</span> (!child) <span class="keywordflow">return</span>;
<a name="l00802"></a>00802                      }
<a name="l00803"></a>00803                  }
<a name="l00804"></a>00804                  <a class="code" href="util_8c.html#a97697166f12dcd5e6fb5651ed7f1031a" title="Print debug message.">printDebug</a>(<span class="stringliteral">&quot;$$$$$ checking element type \n&quot;</span>);
<a name="l00805"></a>00805                  <span class="keywordflow">if</span> (<a class="code" href="xml__parser__cosim_8c.html#affc6288ba88dc03abe7b6ee1cf2289cb" title="Verify that element is of the given type.">checkElementType</a>(child, <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fae945b5751da1f7d2e66a8af994698eb0">elm_fmiModelDescription</a>)) <span class="keywordflow">return</span>;
<a name="l00806"></a>00806                  <a class="code" href="util_8c.html#a97697166f12dcd5e6fb5651ed7f1031a" title="Print debug message.">printDebug</a>(<span class="stringliteral">&quot;$$$$$ checked  element type \n&quot;</span>);
<a name="l00807"></a>00807                  md = (<a class="code" href="structModelDescription.html">ModelDescription</a>*)child;
<a name="l00808"></a>00808 
<a name="l00809"></a>00809                  <span class="comment">// the following build the link of elements for ModelDescriptions</span>
<a name="l00810"></a>00810                  md-&gt;<a class="code" href="structModelDescription.html#a06f6c51301bd9921b391a7b7584b945e">modelVariables</a> = mv;
<a name="l00811"></a>00811                  md-&gt;<a class="code" href="structModelDescription.html#a867d717c11dd3fb2819575c8a00a4334">implementation</a> = im; <span class="comment">// added M. Wetter</span>
<a name="l00812"></a>00812                  md-&gt;<a class="code" href="structModelDescription.html#a1d4be70fe69967905e5a9a49cd5370b8">vendorAnnotations</a> = va;
<a name="l00813"></a>00813                  md-&gt;<a class="code" href="structModelDescription.html#a22fe0fbf22cbca568f485475bcac8274">defaultExperiment</a> = de;
<a name="l00814"></a>00814                  md-&gt;<a class="code" href="structModelDescription.html#a0408f6b6e30e0d722138a25297c01d03">typeDefinitions</a> = td;
<a name="l00815"></a>00815                  md-&gt;<a class="code" href="structModelDescription.html#ade439f086da5269853dbace7e2a2f409">unitDefinitions</a> = ud;
<a name="l00816"></a>00816                  <a class="code" href="util_8c.html#a97697166f12dcd5e6fb5651ed7f1031a" title="Print debug message.">printDebug</a>(<span class="stringliteral">&quot;$$$$$ calling stackPush \n&quot;</span>);
<a name="l00817"></a>00817                  <a class="code" href="stack_8c.html#ab45552969418d7745f0faff4e5854547">stackPush</a>(stack, md);
<a name="l00818"></a>00818                  <a class="code" href="util_8c.html#a97697166f12dcd5e6fb5651ed7f1031a" title="Print debug message.">printDebug</a>(<span class="stringliteral">&quot;$$$$$ called stackPush \n&quot;</span>);
<a name="l00819"></a>00819                  <span class="keywordflow">break</span>;
<a name="l00820"></a>00820             }
<a name="l00821"></a>00821         <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa03d82d44c20820f083cd5749f525156b">elm_Type</a>:
<a name="l00822"></a>00822             {
<a name="l00823"></a>00823                 <a class="code" href="structType.html">Type</a>* tp;
<a name="l00824"></a>00824                 <a class="code" href="structElement.html">Element</a>* ts = <a class="code" href="xml__parser__cosim_8c.html#a8fbde91f0009784906405f7130d96739" title="Get the next stack element of the given type.">checkPop</a>(<a class="code" href="xml__parser__cosim_8c.html#ad11a2f38dcbf340c673b6a9b09ed7185">ANY_TYPE</a>);
<a name="l00825"></a>00825                 <span class="keywordflow">if</span> (!ts) <span class="keywordflow">return</span>;  <span class="comment">// If there is no sub-element, return</span>
<a name="l00826"></a>00826                 <span class="keywordflow">if</span> (<a class="code" href="xml__parser__cosim_8c.html#ae2170a70f8db7fd68d9ebd3c424db511" title="Verify that the next stack element exists and is of the given type.">checkPeek</a>(<a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa03d82d44c20820f083cd5749f525156b">elm_Type</a>)) <span class="keywordflow">return</span>; <span class="comment">// If the sub-element is not Type, return</span>
<a name="l00827"></a>00827                 tp = (<a class="code" href="structType.html">Type</a>*)<a class="code" href="stack_8c.html#ab45ab798c968da8e09ea1c8051c4dea9">stackPeek</a>(stack);  <span class="comment">// Get the element</span>
<a name="l00828"></a>00828                 <span class="keywordflow">switch</span> (ts-&gt;<a class="code" href="structElement.html#a7b29ec1313f99517acb89211871fdd34">type</a>) {
<a name="l00829"></a>00829                     <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fadc09708f188e0076e392029eecdeebaa">elm_RealType</a>:
<a name="l00830"></a>00830                     <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fafe60d70f7a8f1db374984d9ad93b1eec">elm_IntegerType</a>:
<a name="l00831"></a>00831                     <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fac6684c05cf036d8f4d1f944ec4646e37">elm_BooleanType</a>:
<a name="l00832"></a>00832                     <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa6f7382ea290d808b06076a0720c6fb48">elm_EnumerationType</a>:
<a name="l00833"></a>00833                         <span class="keywordflow">break</span>;
<a name="l00834"></a>00834                     <span class="keywordflow">default</span>:        <span class="comment">// Element type does not match</span>
<a name="l00835"></a>00835                          <a class="code" href="xml__parser__cosim_8c.html#aa6201ba845a856a23d8429c51e2a16cb" title="Print the error information for wrong type.">logFatalTypeError</a>(<span class="stringliteral">&quot;RealType or similar&quot;</span>, ts-&gt;<a class="code" href="structElement.html#a7b29ec1313f99517acb89211871fdd34">type</a>);
<a name="l00836"></a>00836                          <span class="keywordflow">return</span>;
<a name="l00837"></a>00837                 }
<a name="l00838"></a>00838                 tp-&gt;<a class="code" href="structType.html#a36ecb0b98e3bcc02efda901e36407d22">typeSpec</a> = ts;      <span class="comment">// parent (tp) links to sub-element (ts)</span>
<a name="l00839"></a>00839                 <span class="keywordflow">break</span>;
<a name="l00840"></a>00840             }
<a name="l00841"></a>00841         <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa839bc3580841101552970a9a3857134b">elm_ScalarVariable</a>:
<a name="l00842"></a>00842             {
<a name="l00843"></a>00843                 <a class="code" href="structScalarVariable.html">ScalarVariable</a>* sv;
<a name="l00844"></a>00844                 <a class="code" href="structElement.html">Element</a>** list = NULL;
<a name="l00845"></a>00845                 <a class="code" href="structElement.html">Element</a>* child = <a class="code" href="xml__parser__cosim_8c.html#a8fbde91f0009784906405f7130d96739" title="Get the next stack element of the given type.">checkPop</a>(<a class="code" href="xml__parser__cosim_8c.html#ad11a2f38dcbf340c673b6a9b09ed7185">ANY_TYPE</a>);
<a name="l00846"></a>00846                 <span class="keywordflow">if</span> (!child) <span class="keywordflow">return</span>;
<a name="l00847"></a>00847                 <span class="keywordflow">if</span> (child-&gt;<a class="code" href="structElement.html#a7b29ec1313f99517acb89211871fdd34">type</a>==<a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa86046f467a534d5f37c5cc86e8eeb246">elm_DirectDependency</a>){
<a name="l00848"></a>00848                     list = ((<a class="code" href="structListElement.html">ListElement</a>*)child)-&gt;list; <span class="comment">// DirectDependency is ListElement</span>
<a name="l00849"></a>00849                     free(child);
<a name="l00850"></a>00850                     child = <a class="code" href="xml__parser__cosim_8c.html#a8fbde91f0009784906405f7130d96739" title="Get the next stack element of the given type.">checkPop</a>(<a class="code" href="xml__parser__cosim_8c.html#ad11a2f38dcbf340c673b6a9b09ed7185">ANY_TYPE</a>);
<a name="l00851"></a>00851                     <span class="keywordflow">if</span> (!child) <span class="keywordflow">return</span>;
<a name="l00852"></a>00852                 }
<a name="l00853"></a>00853                 <span class="keywordflow">if</span> (<a class="code" href="xml__parser__cosim_8c.html#ae2170a70f8db7fd68d9ebd3c424db511" title="Verify that the next stack element exists and is of the given type.">checkPeek</a>(<a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa839bc3580841101552970a9a3857134b">elm_ScalarVariable</a>)) <span class="keywordflow">return</span>;  <span class="comment">// If next element is not ScalarVariable, return</span>
<a name="l00854"></a>00854                 sv = (<a class="code" href="structScalarVariable.html">ScalarVariable</a>*)<a class="code" href="stack_8c.html#ab45ab798c968da8e09ea1c8051c4dea9">stackPeek</a>(stack);
<a name="l00855"></a>00855                 <span class="keywordflow">switch</span> (child-&gt;<a class="code" href="structElement.html#a7b29ec1313f99517acb89211871fdd34">type</a>) {
<a name="l00856"></a>00856                     <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fabb70f90bc7f0e801e505879c40002c9e">elm_Real</a>:
<a name="l00857"></a>00857                     <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa31fb1361c495778fa9e495771fcaa94c">elm_Integer</a>:
<a name="l00858"></a>00858                     <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa493527b21665f01720a5b77c7cc78368">elm_Boolean</a>:
<a name="l00859"></a>00859                     <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa49bd7edeb15a16ec96fe458782879cec">elm_Enumeration</a>:
<a name="l00860"></a>00860                         <span class="keywordflow">break</span>;
<a name="l00861"></a>00861                     <span class="keywordflow">default</span>:
<a name="l00862"></a>00862                          <a class="code" href="xml__parser__cosim_8c.html#aa6201ba845a856a23d8429c51e2a16cb" title="Print the error information for wrong type.">logFatalTypeError</a>(<span class="stringliteral">&quot;Real or similar&quot;</span>, child-&gt;<a class="code" href="structElement.html#a7b29ec1313f99517acb89211871fdd34">type</a>);
<a name="l00863"></a>00863                          <span class="keywordflow">return</span>;
<a name="l00864"></a>00864                 }
<a name="l00865"></a>00865                 sv-&gt;<a class="code" href="structScalarVariable.html#a5cce8dca0149b1600c8a1330431acff3">directDependencies</a> = list;
<a name="l00866"></a>00866                 sv-&gt;<a class="code" href="structScalarVariable.html#a3563abf1de77f1e99c86851aefaa7650">typeSpec</a> = child;
<a name="l00867"></a>00867                 <span class="keywordflow">break</span>;
<a name="l00868"></a>00868             }
<a name="l00869"></a>00869         <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa03df9dd2c5b4b5e3a94d2617a968c200">elm_Implementation</a>:    <a class="code" href="xml__parser__cosim_8c.html#a8e4972c1fe738628f1021ebce255b673" title="Pop all elements of the given type from stack and add it to the ListElement that follows.">popList</a>(<a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fae687fdb02391a2f8d37faf3a8aacc434">elm_CoSimulation_StandAlone</a>); <span class="keywordflow">break</span>; <span class="comment">// Needs to be modified if CoSimulation_Tool is added</span>
<a name="l00870"></a>00870         <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fae687fdb02391a2f8d37faf3a8aacc434">elm_CoSimulation_StandAlone</a>:  <a class="code" href="xml__parser__cosim_8c.html#a8e4972c1fe738628f1021ebce255b673" title="Pop all elements of the given type from stack and add it to the ListElement that follows.">popList</a>(<a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa99599cf787c020146cec3a8b6807be9e">elm_Capabilities</a>); <span class="keywordflow">break</span>; <span class="comment">// CoSimulation_StandAlone only has Capabilities</span>
<a name="l00871"></a>00871         <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa9f2d508373be462de014ebb0d7fd8c23">elm_ModelVariables</a>:    <a class="code" href="xml__parser__cosim_8c.html#a8e4972c1fe738628f1021ebce255b673" title="Pop all elements of the given type from stack and add it to the ListElement that follows.">popList</a>(<a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa839bc3580841101552970a9a3857134b">elm_ScalarVariable</a>); <span class="keywordflow">break</span>;
<a name="l00872"></a>00872         <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa7e38ebbd4fe0a2181c077516ba80d34d">elm_VendorAnnotations</a>: <a class="code" href="xml__parser__cosim_8c.html#a8e4972c1fe738628f1021ebce255b673" title="Pop all elements of the given type from stack and add it to the ListElement that follows.">popList</a>(<a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa5c688a86933559f64f014b1835c5679c">elm_Tool</a>);<span class="keywordflow">break</span>;
<a name="l00873"></a>00873         <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa5c688a86933559f64f014b1835c5679c">elm_Tool</a>:              <a class="code" href="xml__parser__cosim_8c.html#a8e4972c1fe738628f1021ebce255b673" title="Pop all elements of the given type from stack and add it to the ListElement that follows.">popList</a>(<a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa6c01405718366aa3242c7c07c578e1a8">elm_Annotation</a>); <span class="keywordflow">break</span>;
<a name="l00874"></a>00874         <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fab7c46c3aad226c6ac4e2772b6eed8e30">elm_TypeDefinitions</a>:   <a class="code" href="xml__parser__cosim_8c.html#a8e4972c1fe738628f1021ebce255b673" title="Pop all elements of the given type from stack and add it to the ListElement that follows.">popList</a>(<a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa03d82d44c20820f083cd5749f525156b">elm_Type</a>); <span class="keywordflow">break</span>;
<a name="l00875"></a>00875         <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa6f7382ea290d808b06076a0720c6fb48">elm_EnumerationType</a>:   <a class="code" href="xml__parser__cosim_8c.html#a8e4972c1fe738628f1021ebce255b673" title="Pop all elements of the given type from stack and add it to the ListElement that follows.">popList</a>(<a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa94cb689ec4a9b925888f5ba08b36f475">elm_Item</a>); <span class="keywordflow">break</span>;
<a name="l00876"></a>00876         <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa69dd315a1b8dad521d323967b7bb5457">elm_UnitDefinitions</a>:   <a class="code" href="xml__parser__cosim_8c.html#a8e4972c1fe738628f1021ebce255b673" title="Pop all elements of the given type from stack and add it to the ListElement that follows.">popList</a>(<a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668faf9efccd479ea377955494e55fe91cc96">elm_BaseUnit</a>); <span class="keywordflow">break</span>;
<a name="l00877"></a>00877         <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668faf9efccd479ea377955494e55fe91cc96">elm_BaseUnit</a>:          <a class="code" href="xml__parser__cosim_8c.html#a8e4972c1fe738628f1021ebce255b673" title="Pop all elements of the given type from stack and add it to the ListElement that follows.">popList</a>(<a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fafa2c71fc3c410a9d6a8c5c45c5d45c55">elm_DisplayUnitDefinition</a>); <span class="keywordflow">break</span>;
<a name="l00878"></a>00878         <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa86046f467a534d5f37c5cc86e8eeb246">elm_DirectDependency</a>:  <a class="code" href="xml__parser__cosim_8c.html#a8e4972c1fe738628f1021ebce255b673" title="Pop all elements of the given type from stack and add it to the ListElement that follows.">popList</a>(<a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa3ccaf33a433f3f7765ae2c0eb6f293df">elm_Name</a>); <span class="keywordflow">break</span>;
<a name="l00879"></a>00879         <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa3ccaf33a433f3f7765ae2c0eb6f293df">elm_Name</a>:
<a name="l00880"></a>00880             {
<a name="l00881"></a>00881                  <span class="comment">// Exception: the name value is represented as element content.</span>
<a name="l00882"></a>00882                  <span class="comment">// All other values of the XML file are represented using attributes.</span>
<a name="l00883"></a>00883                  <a class="code" href="structElement.html">Element</a>* <a class="code" href="expat_8h.html#a1b49b495b59f9e73205b69ad1a2965b0">name</a> = <a class="code" href="xml__parser__cosim_8c.html#a8fbde91f0009784906405f7130d96739" title="Get the next stack element of the given type.">checkPop</a>(<a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa3ccaf33a433f3f7765ae2c0eb6f293df">elm_Name</a>);
<a name="l00884"></a>00884                  <span class="keywordflow">if</span> (!name) <span class="keywordflow">return</span>;
<a name="l00885"></a>00885                  name-&gt;<a class="code" href="structElement.html#a53875a4f352401abdf5605c29b45e9ad">n</a> = 2;
<a name="l00886"></a>00886                  name-&gt;<a class="code" href="structElement.html#aaebbd64792617c5e74c37669a8e17795">attributes</a> = malloc(2*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>*));
<a name="l00887"></a>00887                  name-&gt;<a class="code" href="structElement.html#aaebbd64792617c5e74c37669a8e17795">attributes</a>[0] = <a class="code" href="xml__parser__cosim_8c.html#ad43413b3e633885aeb1fafea5deb5d57">attNames</a>[<a class="code" href="xml__parser__cosim_8h.html#a59159c2e4de0af530912e1e58c84bacfadc2828b73cd0eed4b37543db3d984213">att_input</a>];
<a name="l00888"></a>00888                  name-&gt;<a class="code" href="structElement.html#aaebbd64792617c5e74c37669a8e17795">attributes</a>[1] = <a class="code" href="expat_8h.html#a1330208ca988f17841d64208a3bc3935">data</a>;
<a name="l00889"></a>00889                  <a class="code" href="expat_8h.html#a1330208ca988f17841d64208a3bc3935">data</a> = NULL;
<a name="l00890"></a>00890                  <a class="code" href="xml__parser__cosim_8c.html#ac957c246a7bf701c778beba4fb6b0e14">skipData</a> = 1; <span class="comment">// stop recording element content</span>
<a name="l00891"></a>00891                  <a class="code" href="stack_8c.html#ab45552969418d7745f0faff4e5854547">stackPush</a>(stack, name);
<a name="l00892"></a>00892                  <span class="keywordflow">break</span>;
<a name="l00893"></a>00893             }
<a name="l00894"></a>00894         <span class="keywordflow">case</span> -1: <span class="keywordflow">return</span>; <span class="comment">// illegal element error</span>
<a name="l00895"></a>00895         <span class="keywordflow">default</span>: <span class="comment">// must be a leaf Element</span>
<a name="l00896"></a>00896                 <a class="code" href="util_8c.html#a97697166f12dcd5e6fb5651ed7f1031a" title="Print debug message.">printDebug</a>(<span class="stringliteral">&quot;+++++++ got a leaf element\n&quot;</span>);
<a name="l00897"></a>00897                 assert(<a class="code" href="xml__parser__cosim_8c.html#ad1a30703c17843827888269abe029299" title="Get AST node type.">getAstNodeType</a>(el)==<a class="code" href="xml__parser__cosim_8h.html#a1e0354e1cfa4d729a8b30688d18256fda99ad3c1adf1417b269f139519c1951ee">astElement</a>);
<a name="l00898"></a>00898                 <span class="keywordflow">break</span>;
<a name="l00899"></a>00899     }
<a name="l00900"></a>00900     <span class="comment">// All children of el removed from the stack.</span>
<a name="l00901"></a>00901     <span class="comment">// The top element must be of type el now.</span>
<a name="l00902"></a>00902     <a class="code" href="xml__parser__cosim_8c.html#ae2170a70f8db7fd68d9ebd3c424db511" title="Verify that the next stack element exists and is of the given type.">checkPeek</a>(el);
<a name="l00903"></a>00903 }
<a name="l00904"></a>00904 
<a name="l00916"></a><a class="code" href="xml__parser__cosim_8c.html#a2fdc2e8b1023b7165274430f6f54f470">00916</a> <span class="keywordtype">void</span> <a class="code" href="expat__external_8h.html#aad85d290912c3ffed7a2ec0b6173dad3">XMLCALL</a> <a class="code" href="xml__parser__cosim_8c.html#a2fdc2e8b1023b7165274430f6f54f470" title="Handle element data.">handleData</a>(<span class="keywordtype">void</span> *<a class="code" href="expat_8h.html#afe0934df1732463fe5378d8c8724edc6">context</a>, <span class="keyword">const</span> <a class="code" href="expat__external_8h.html#a63da96463e775e1ec3a7d1f076208127">XML_Char</a> *<a class="code" href="expat_8h.html#a755339d27872b13735c2cab829e47157">s</a>, <span class="keywordtype">int</span> <a class="code" href="expat_8h.html#af86d325fecfc8f47b61fbf5a5146f582">len</a>) {
<a name="l00917"></a>00917     <span class="keywordtype">int</span> n;
<a name="l00918"></a>00918     <span class="keywordflow">if</span> (<a class="code" href="xml__parser__cosim_8c.html#ac957c246a7bf701c778beba4fb6b0e14">skipData</a>) <span class="keywordflow">return</span>;
<a name="l00919"></a>00919     <span class="keywordflow">if</span> (!<a class="code" href="expat_8h.html#a1330208ca988f17841d64208a3bc3935">data</a>) {
<a name="l00920"></a>00920         <span class="comment">// start a new data string</span>
<a name="l00921"></a>00921         <span class="keywordflow">if</span> (len == 1 &amp;&amp; s[0] == <span class="charliteral">&#39;\n&#39;</span>) {
<a name="l00922"></a>00922             <a class="code" href="expat_8h.html#a1330208ca988f17841d64208a3bc3935">data</a> = strdup(<span class="stringliteral">&quot;&quot;</span>);
<a name="l00923"></a>00923         } <span class="keywordflow">else</span> {
<a name="l00924"></a>00924             <a class="code" href="expat_8h.html#a1330208ca988f17841d64208a3bc3935">data</a> = malloc(len + 1);
<a name="l00925"></a>00925             strncpy(<a class="code" href="expat_8h.html#a1330208ca988f17841d64208a3bc3935">data</a>, s, len);
<a name="l00926"></a>00926             <a class="code" href="expat_8h.html#a1330208ca988f17841d64208a3bc3935">data</a>[<a class="code" href="expat_8h.html#af86d325fecfc8f47b61fbf5a5146f582">len</a>] = <span class="charliteral">&#39;\0&#39;</span>;
<a name="l00927"></a>00927         }
<a name="l00928"></a>00928     }
<a name="l00929"></a>00929     <span class="keywordflow">else</span> {
<a name="l00930"></a>00930         <span class="comment">// continue existing string</span>
<a name="l00931"></a>00931         n = strlen(<a class="code" href="expat_8h.html#a1330208ca988f17841d64208a3bc3935">data</a>) + <a class="code" href="expat_8h.html#af86d325fecfc8f47b61fbf5a5146f582">len</a>;
<a name="l00932"></a>00932         <a class="code" href="expat_8h.html#a1330208ca988f17841d64208a3bc3935">data</a> = realloc(<a class="code" href="expat_8h.html#a1330208ca988f17841d64208a3bc3935">data</a>, n+1);
<a name="l00933"></a>00933         strncat(<a class="code" href="expat_8h.html#a1330208ca988f17841d64208a3bc3935">data</a>, s, len);
<a name="l00934"></a>00934         <a class="code" href="expat_8h.html#a1330208ca988f17841d64208a3bc3935">data</a>[n] = <span class="charliteral">&#39;\0&#39;</span>;
<a name="l00935"></a>00935     }
<a name="l00936"></a>00936     <span class="keywordflow">return</span>;
<a name="l00937"></a>00937 }
<a name="l00938"></a>00938 
<a name="l00945"></a>00945 
<a name="l00946"></a><a class="code" href="xml__parser__cosim_8c.html#af3f92eae3a770e7cd8aee88580c10c5b">00946</a> <span class="keywordtype">void</span> <a class="code" href="xml__parser__cosim_8c.html#af3f92eae3a770e7cd8aee88580c10c5b" title="Print element information.">printElement</a>(<span class="keywordtype">int</span> indent, <span class="keywordtype">void</span>* element){
<a name="l00947"></a>00947     <span class="keywordtype">int</span> <a class="code" href="fmuTemplate_8h.html#ad51f78a2c68c740b5b1d4fa9bda8500f">i</a>;
<a name="l00948"></a>00948     <a class="code" href="structElement.html">Element</a>* e = (<a class="code" href="structElement.html">Element</a>*)element;
<a name="l00949"></a>00949     <a class="code" href="structModelDescription.html">ModelDescription</a>* md;
<a name="l00950"></a>00950     <span class="keywordflow">if</span> (!e) <span class="keywordflow">return</span>;
<a name="l00951"></a>00951     <span class="comment">// print attributes</span>
<a name="l00952"></a>00952     <span class="keywordflow">for</span> (i=0; i&lt;indent; i++) printf(<span class="stringliteral">&quot; &quot;</span>);
<a name="l00953"></a>00953     printf(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code" href="xml__parser__cosim_8c.html#a1dacbe49ed03276788f8f6352f8054c2">elmNames</a>[e-&gt;<a class="code" href="structElement.html#a7b29ec1313f99517acb89211871fdd34">type</a>]);
<a name="l00954"></a>00954     <span class="keywordflow">for</span> (i=0; i&lt;e-&gt;<a class="code" href="structElement.html#a53875a4f352401abdf5605c29b45e9ad">n</a>; i+=2) 
<a name="l00955"></a>00955         printf(<span class="stringliteral">&quot; %s=%s&quot;</span>, e-&gt;<a class="code" href="structElement.html#aaebbd64792617c5e74c37669a8e17795">attributes</a>[i], e-&gt;<a class="code" href="structElement.html#aaebbd64792617c5e74c37669a8e17795">attributes</a>[i+1]);
<a name="l00956"></a>00956     printf(<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00957"></a>00957     <span class="comment">// print child nodes</span>
<a name="l00958"></a>00958     indent += 2;
<a name="l00959"></a>00959     <span class="keywordflow">switch</span> (<a class="code" href="xml__parser__cosim_8c.html#ad1a30703c17843827888269abe029299" title="Get AST node type.">getAstNodeType</a>(e-&gt;<a class="code" href="structElement.html#a7b29ec1313f99517acb89211871fdd34">type</a>)) {
<a name="l00960"></a>00960         <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a1e0354e1cfa4d729a8b30688d18256fda7182392768c00d0cdf9748030778b6b6">astListElement</a>:
<a name="l00961"></a>00961             <a class="code" href="xml__parser__cosim_8c.html#a5c08b05ea59ce8512f3ff4e52b7d07d3" title="Print information for list of elements.">printList</a>(indent, (<span class="keywordtype">void</span> **)((<a class="code" href="structListElement.html">ListElement</a>*)e)-&gt;list);
<a name="l00962"></a>00962             <span class="keywordflow">break</span>;
<a name="l00963"></a>00963         <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a1e0354e1cfa4d729a8b30688d18256fda45324db20815b75eebd19f24122de91a">astScalarVariable</a>:
<a name="l00964"></a>00964             <a class="code" href="xml__parser__cosim_8c.html#af3f92eae3a770e7cd8aee88580c10c5b" title="Print element information.">printElement</a>(indent, ((<a class="code" href="structType.html">Type</a>*)e)-&gt;typeSpec);
<a name="l00965"></a>00965             <a class="code" href="xml__parser__cosim_8c.html#a5c08b05ea59ce8512f3ff4e52b7d07d3" title="Print information for list of elements.">printList</a>(indent, (<span class="keywordtype">void</span> **)((<a class="code" href="structScalarVariable.html">ScalarVariable</a>*)e)-&gt;directDependencies);
<a name="l00966"></a>00966             <span class="keywordflow">break</span>;
<a name="l00967"></a>00967         <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a1e0354e1cfa4d729a8b30688d18256fda43c9857656d7e3bc7f69e4d7f3bb0f41">astType</a>:
<a name="l00968"></a>00968             <a class="code" href="xml__parser__cosim_8c.html#af3f92eae3a770e7cd8aee88580c10c5b" title="Print element information.">printElement</a>(indent, ((<a class="code" href="structType.html">Type</a>*)e)-&gt;typeSpec);
<a name="l00969"></a>00969             <span class="keywordflow">break</span>;
<a name="l00970"></a>00970         <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a1e0354e1cfa4d729a8b30688d18256fdacdf46b059af7e2210dd6d5af340d7b17">astModelDescription</a>:
<a name="l00971"></a>00971             md = (<a class="code" href="structModelDescription.html">ModelDescription</a>*)e;
<a name="l00972"></a>00972             <a class="code" href="xml__parser__cosim_8c.html#a5c08b05ea59ce8512f3ff4e52b7d07d3" title="Print information for list of elements.">printList</a>(indent, (<span class="keywordtype">void</span> **)md-&gt;<a class="code" href="structModelDescription.html#ade439f086da5269853dbace7e2a2f409">unitDefinitions</a>);
<a name="l00973"></a>00973             <a class="code" href="xml__parser__cosim_8c.html#a5c08b05ea59ce8512f3ff4e52b7d07d3" title="Print information for list of elements.">printList</a>(indent, (<span class="keywordtype">void</span> **)md-&gt;<a class="code" href="structModelDescription.html#a0408f6b6e30e0d722138a25297c01d03">typeDefinitions</a>);
<a name="l00974"></a>00974             <a class="code" href="xml__parser__cosim_8c.html#af3f92eae3a770e7cd8aee88580c10c5b" title="Print element information.">printElement</a>(indent, md-&gt;<a class="code" href="structModelDescription.html#a22fe0fbf22cbca568f485475bcac8274">defaultExperiment</a>);
<a name="l00975"></a>00975             <a class="code" href="xml__parser__cosim_8c.html#a5c08b05ea59ce8512f3ff4e52b7d07d3" title="Print information for list of elements.">printList</a>(indent, (<span class="keywordtype">void</span> **)md-&gt;<a class="code" href="structModelDescription.html#a1d4be70fe69967905e5a9a49cd5370b8">vendorAnnotations</a>);
<a name="l00976"></a>00976             <a class="code" href="xml__parser__cosim_8c.html#a5c08b05ea59ce8512f3ff4e52b7d07d3" title="Print information for list of elements.">printList</a>(indent, (<span class="keywordtype">void</span> **)md-&gt;<a class="code" href="structModelDescription.html#a06f6c51301bd9921b391a7b7584b945e">modelVariables</a>);
<a name="l00977"></a>00977             <a class="code" href="xml__parser__cosim_8c.html#a5c08b05ea59ce8512f3ff4e52b7d07d3" title="Print information for list of elements.">printList</a>(indent, (<span class="keywordtype">void</span> **)md-&gt;<a class="code" href="structModelDescription.html#a867d717c11dd3fb2819575c8a00a4334">implementation</a>); <span class="comment">// added W. Zuo</span>
<a name="l00978"></a>00978             <span class="keywordflow">break</span>;
<a name="l00979"></a>00979     }
<a name="l00980"></a>00980 }
<a name="l00981"></a>00981 
<a name="l00988"></a><a class="code" href="xml__parser__cosim_8c.html#a5c08b05ea59ce8512f3ff4e52b7d07d3">00988</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="xml__parser__cosim_8c.html#a5c08b05ea59ce8512f3ff4e52b7d07d3" title="Print information for list of elements.">printList</a>(<span class="keywordtype">int</span> indent, <span class="keywordtype">void</span>** list){
<a name="l00989"></a>00989     <span class="keywordtype">int</span> <a class="code" href="fmuTemplate_8h.html#ad51f78a2c68c740b5b1d4fa9bda8500f">i</a>;
<a name="l00990"></a>00990     <span class="keywordflow">if</span> (list) <span class="keywordflow">for</span> (i=0; list[<a class="code" href="fmuTemplate_8h.html#ad51f78a2c68c740b5b1d4fa9bda8500f">i</a>]; i++) 
<a name="l00991"></a>00991        <a class="code" href="xml__parser__cosim_8c.html#af3f92eae3a770e7cd8aee88580c10c5b" title="Print element information.">printElement</a>(indent, list[i]);
<a name="l00992"></a>00992 }
<a name="l00993"></a>00993 
<a name="l00999"></a><a class="code" href="xml__parser__cosim_8c.html#ab66eb373a3ed73c50cedeae72430a980">00999</a> <span class="keywordtype">void</span> <a class="code" href="xml__parser__cosim_8c.html#ab66eb373a3ed73c50cedeae72430a980" title="Generate idf file for EnergyPlus.">printidf</a>(<a class="code" href="structModelDescription.html">ModelDescription</a>* md)
<a name="l01000"></a>01000 {
<a name="l01001"></a>01001     FILE *fp;
<a name="l01002"></a>01002     <span class="keywordtype">char</span> fmuname[100], type[12];
<a name="l01003"></a>01003     <span class="keywordtype">int</span> <a class="code" href="fmuTemplate_8h.html#ad51f78a2c68c740b5b1d4fa9bda8500f">i</a>, j, varname, vardes;
<a name="l01004"></a>01004     <span class="keywordtype">void</span> **list;
<a name="l01005"></a>01005     <a class="code" href="structScalarVariable.html">ScalarVariable</a>* se;
<a name="l01006"></a>01006     <a class="code" href="structElement.html">Element</a>* ee;
<a name="l01007"></a>01007 
<a name="l01008"></a>01008     fp = fopen(<span class="stringliteral">&quot;tmp.idf&quot;</span>, <span class="stringliteral">&quot;w&quot;</span>);
<a name="l01009"></a>01009 
<a name="l01010"></a>01010     <span class="keywordflow">if</span> (fp == NULL) {
<a name="l01011"></a>01011       printf(<span class="stringliteral">&quot;Can&#39;t create temporary idf file!\n&quot;</span>);
<a name="l01012"></a>01012       exit(42);  <span class="comment">// STL error code: File not open.</span>
<a name="l01013"></a>01013     }
<a name="l01014"></a>01014 
<a name="l01016"></a>01016     <span class="comment">// Define ExternalInterface</span>
<a name="l01017"></a>01017     fprintf(fp, <span class="stringliteral">&quot;ExternalInterface,\n&quot;</span>);
<a name="l01018"></a>01018     fprintf(fp, <span class="stringliteral">&quot;  FunctionalMockUpUnit;\n&quot;</span>);
<a name="l01019"></a>01019 
<a name="l01021"></a>01021   <span class="comment">// Define ExternalInterface:FunctionalMockupUnit</span>
<a name="l01022"></a>01022     fprintf(fp, <span class="stringliteral">&quot;\nExternalInterface:FunctionalMockupUnit,\n&quot;</span>);
<a name="l01023"></a>01023     <span class="keywordflow">for</span>(i=0; i&lt;md-&gt;<a class="code" href="structModelDescription.html#a5b78009f2d74c20c7231214ee2ed01e0">n</a>; i+=2)
<a name="l01024"></a>01024         <span class="keywordflow">if</span>(!strcmp(md-&gt;<a class="code" href="structModelDescription.html#ad1037fe5479ee1654987b01e510c347e">attributes</a>[i], <span class="stringliteral">&quot;modelIdentifier&quot;</span>))
<a name="l01025"></a>01025             strcpy(fmuname, md-&gt;<a class="code" href="structModelDescription.html#ad1037fe5479ee1654987b01e510c347e">attributes</a>[i+1]);
<a name="l01026"></a>01026     fprintf(fp, <span class="stringliteral">&quot;  %s.fmu;\n&quot;</span>, fmuname);
<a name="l01027"></a>01027 
<a name="l01028"></a>01028     list = (<span class="keywordtype">void</span> **)md-&gt;<a class="code" href="structModelDescription.html#a06f6c51301bd9921b391a7b7584b945e">modelVariables</a>;
<a name="l01029"></a>01029     if (list)
<a name="l01030"></a>01030         <span class="keywordflow">for</span>(j=0; list[j]; j++)
<a name="l01031"></a>01031         {
<a name="l01032"></a>01032             <a class="code" href="structElement.html">Element</a>* e = (<a class="code" href="structElement.html">Element</a>*)list[j];
<a name="l01033"></a>01033             <a class="code" href="xml__parser__cosim_8h.html#aea7ea6e61f6b28ce9df951528de712ba">Enu</a> val;
<a name="l01034"></a>01034 
<a name="l01035"></a>01035             <span class="keywordflow">for</span>(i=0; i&lt;e-&gt;<a class="code" href="structElement.html#a53875a4f352401abdf5605c29b45e9ad">n</a>; i+=2)
<a name="l01036"></a>01036             {
<a name="l01037"></a>01037                 <span class="keywordflow">if</span>(!strcmp(e-&gt;<a class="code" href="structElement.html#aaebbd64792617c5e74c37669a8e17795">attributes</a>[i], <span class="stringliteral">&quot;name&quot;</span>))
<a name="l01038"></a>01038                     varname = i+1;
<a name="l01039"></a>01039                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(e-&gt;<a class="code" href="structElement.html#aaebbd64792617c5e74c37669a8e17795">attributes</a>[i], <span class="stringliteral">&quot;causality&quot;</span>))
<a name="l01040"></a>01040                     val = <a class="code" href="xml__parser__cosim_8c.html#a53596f97ec1e04d04bc7a6eac85d9381" title="Check enum value of input string enu.">checkEnumValue</a>(e-&gt;<a class="code" href="structElement.html#aaebbd64792617c5e74c37669a8e17795">attributes</a>[i+1]);
<a name="l01041"></a>01041                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(e-&gt;<a class="code" href="structElement.html#aaebbd64792617c5e74c37669a8e17795">attributes</a>[i], <span class="stringliteral">&quot;description&quot;</span>))
<a name="l01042"></a>01042                     vardes = i+1;
<a name="l01043"></a>01043             }
<a name="l01044"></a>01044 
<a name="l01046"></a>01046       <span class="comment">// Define ExternalInterface:FunctionalMockupUnit:Input:Variable</span>
<a name="l01047"></a>01047       <span class="comment">// Define part of ExternalInterface:FunctionalMockupUnit:Output      </span>
<a name="l01048"></a>01048             <span class="keywordflow">if</span>(val == <a class="code" href="xml__parser__cosim_8h.html#aea7ea6e61f6b28ce9df951528de712baa4399159e75de569961fcded50c47a55f">enu_input</a> || val == <a class="code" href="xml__parser__cosim_8h.html#aea7ea6e61f6b28ce9df951528de712baaa231247b37391aface4728a824beeaf1">enu_output</a>)
<a name="l01049"></a>01049             {
<a name="l01050"></a>01050                 <span class="keywordflow">switch</span> (val)
<a name="l01051"></a>01051                 {
<a name="l01052"></a>01052                     <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#aea7ea6e61f6b28ce9df951528de712baa4399159e75de569961fcded50c47a55f">enu_input</a>:
<a name="l01053"></a>01053                         fprintf(fp, <span class="stringliteral">&quot;\nExternalInterface:FunctionalMockupUnit:Input:Variable,\n&quot;</span>);
<a name="l01054"></a>01054                         <span class="keywordflow">break</span>;
<a name="l01055"></a>01055                     <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#aea7ea6e61f6b28ce9df951528de712baaa231247b37391aface4728a824beeaf1">enu_output</a>:
<a name="l01056"></a>01056             <span class="comment">// User should manually define the Output type: Schedule, Actuator, Variable</span>
<a name="l01057"></a>01057                         fprintf(fp, <span class="stringliteral">&quot;\nExternalInterface:FunctionalMockupUnit:Output,\n&quot;</span>);
<a name="l01058"></a>01058                         <span class="keywordflow">break</span>;
<a name="l01059"></a>01059                     <span class="keywordflow">default</span>:
<a name="l01060"></a>01060                         <span class="keywordflow">break</span>;
<a name="l01061"></a>01061                 }
<a name="l01062"></a>01062                 fprintf(fp, <span class="stringliteral">&quot;   %s,\t\t!- FMU Filename\n&quot;</span>, fmuname);
<a name="l01063"></a>01063                 fprintf(fp, <span class="stringliteral">&quot;   ,\t\t!- FMU ModelName\n&quot;</span>);
<a name="l01064"></a>01064                 fprintf(fp, <span class="stringliteral">&quot;   %s,\t\t!- FMU Model Variable Name&quot;</span>, e-&gt;<a class="code" href="structElement.html#aaebbd64792617c5e74c37669a8e17795">attributes</a>[varname]);
<a name="l01065"></a>01065                 se = (<a class="code" href="structScalarVariable.html">ScalarVariable</a>*)list[j];
<a name="l01066"></a>01066                 ee = se-&gt;<a class="code" href="structScalarVariable.html#a3563abf1de77f1e99c86851aefaa7650">typeSpec</a>;
<a name="l01067"></a>01067                 <span class="keywordflow">switch</span>(ee-&gt;<a class="code" href="structElement.html#a7b29ec1313f99517acb89211871fdd34">type</a>)
<a name="l01068"></a>01068                 {
<a name="l01069"></a>01069                     <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa31fb1361c495778fa9e495771fcaa94c">elm_Integer</a>:
<a name="l01070"></a>01070                         strcpy(type, <span class="stringliteral">&quot;Integer&quot;</span>);    <span class="keywordflow">break</span>;
<a name="l01071"></a>01071                     <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fabb70f90bc7f0e801e505879c40002c9e">elm_Real</a>:
<a name="l01072"></a>01072                         strcpy(type, <span class="stringliteral">&quot;Real&quot;</span>);       <span class="keywordflow">break</span>;
<a name="l01073"></a>01073                     <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa493527b21665f01720a5b77c7cc78368">elm_Boolean</a>:
<a name="l01074"></a>01074                         strcpy(type, <span class="stringliteral">&quot;Boolean&quot;</span>);    <span class="keywordflow">break</span>;
<a name="l01075"></a>01075                     <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa68516efd31d0e86b985b8d691622307a">elm_String</a>:
<a name="l01076"></a>01076                         strcpy(type, <span class="stringliteral">&quot;String&quot;</span>);     <span class="keywordflow">break</span>;
<a name="l01077"></a>01077                     <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a62c25c295217ec85ef07f131f15f668fa49bd7edeb15a16ec96fe458782879cec">elm_Enumeration</a>:
<a name="l01078"></a>01078                         strcpy(type, <span class="stringliteral">&quot;Enumeration&quot;</span>); <span class="keywordflow">break</span>;
<a name="l01079"></a>01079                     <span class="keywordflow">default</span>:
<a name="l01080"></a>01080                         <span class="keywordflow">break</span>;
<a name="l01081"></a>01081                 }
<a name="l01082"></a>01082                 fprintf(fp, <span class="stringliteral">&quot;, %s&quot;</span>, e-&gt;<a class="code" href="structElement.html#aaebbd64792617c5e74c37669a8e17795">attributes</a>[vardes]);
<a name="l01083"></a>01083                 fprintf(fp, <span class="stringliteral">&quot;, %s\n&quot;</span>, type); <span class="comment">//Type of variable</span>
<a name="l01084"></a>01084 
<a name="l01085"></a>01085         <span class="keywordflow">if</span> (val == <a class="code" href="xml__parser__cosim_8h.html#aea7ea6e61f6b28ce9df951528de712baa4399159e75de569961fcded50c47a55f">enu_input</a>) 
<a name="l01086"></a>01086           fprintf(fp, <span class="stringliteral">&quot;   ;\t\t!- Energyplus Variable Name\n&quot;</span>);
<a name="l01087"></a>01087         <span class="keywordflow">else</span> 
<a name="l01088"></a>01088           fprintf(fp, <span class="stringliteral">&quot;   ,\t\t!- Energyplus Variable Name\n&quot;</span>);
<a name="l01089"></a>01089             }
<a name="l01090"></a>01090     }
<a name="l01091"></a>01091     fclose(fp);
<a name="l01092"></a>01092 }
<a name="l01093"></a>01093 
<a name="l01094"></a>01094 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="xml__parser__cosim_8c.html#a4e5e1ae04eeb5a5d6bba207e0123e713" title="Free list.">freeList</a>(<span class="keywordtype">void</span>** list);
<a name="l01095"></a>01095 
<a name="l01101"></a><a class="code" href="xml__parser__cosim_8h.html#aaebcecf323c362bc8d9fe1765a0586dd">01101</a> <span class="keywordtype">void</span> <a class="code" href="xml__parser__cosim_8c.html#aaebcecf323c362bc8d9fe1765a0586dd" title="Free element which may contain list of elements.">freeElement</a>(<span class="keywordtype">void</span>* element){
<a name="l01102"></a>01102     <span class="keywordtype">int</span> <a class="code" href="fmuTemplate_8h.html#ad51f78a2c68c740b5b1d4fa9bda8500f">i</a>;
<a name="l01103"></a>01103     <a class="code" href="structElement.html">Element</a>* e = (<a class="code" href="structElement.html">Element</a>*)element;
<a name="l01104"></a>01104     <a class="code" href="structModelDescription.html">ModelDescription</a>* md;
<a name="l01105"></a>01105     <span class="keywordflow">if</span> (!e) <span class="keywordflow">return</span>;
<a name="l01106"></a>01106     <span class="comment">// free attributes</span>
<a name="l01107"></a>01107     <span class="keywordflow">for</span> (i=0; i&lt;e-&gt;<a class="code" href="structElement.html#a53875a4f352401abdf5605c29b45e9ad">n</a>; i+=2) 
<a name="l01108"></a>01108         free((<span class="keywordtype">void</span> *)e-&gt;<a class="code" href="structElement.html#aaebbd64792617c5e74c37669a8e17795">attributes</a>[i+1]);
<a name="l01109"></a>01109     free(e-&gt;<a class="code" href="structElement.html#aaebbd64792617c5e74c37669a8e17795">attributes</a>);
<a name="l01110"></a>01110     <span class="comment">// free child nodes</span>
<a name="l01111"></a>01111     <span class="keywordflow">switch</span> (<a class="code" href="xml__parser__cosim_8c.html#ad1a30703c17843827888269abe029299" title="Get AST node type.">getAstNodeType</a>(e-&gt;<a class="code" href="structElement.html#a7b29ec1313f99517acb89211871fdd34">type</a>)) {
<a name="l01112"></a>01112         <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a1e0354e1cfa4d729a8b30688d18256fda7182392768c00d0cdf9748030778b6b6">astListElement</a>:
<a name="l01113"></a>01113             <a class="code" href="xml__parser__cosim_8c.html#a4e5e1ae04eeb5a5d6bba207e0123e713" title="Free list.">freeList</a>((<span class="keywordtype">void</span> **)((<a class="code" href="structListElement.html">ListElement</a>*)e)-&gt;list);
<a name="l01114"></a>01114             <span class="keywordflow">break</span>;
<a name="l01115"></a>01115         <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a1e0354e1cfa4d729a8b30688d18256fda45324db20815b75eebd19f24122de91a">astScalarVariable</a>:
<a name="l01116"></a>01116             <a class="code" href="xml__parser__cosim_8c.html#a4e5e1ae04eeb5a5d6bba207e0123e713" title="Free list.">freeList</a>((<span class="keywordtype">void</span> **)((<a class="code" href="structScalarVariable.html">ScalarVariable</a>*)e)-&gt;directDependencies);
<a name="l01117"></a>01117         <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a1e0354e1cfa4d729a8b30688d18256fda43c9857656d7e3bc7f69e4d7f3bb0f41">astType</a>:
<a name="l01118"></a>01118             <a class="code" href="xml__parser__cosim_8c.html#aaebcecf323c362bc8d9fe1765a0586dd" title="Free element which may contain list of elements.">freeElement</a>(((<a class="code" href="structType.html">Type</a>*)e)-&gt;typeSpec);
<a name="l01119"></a>01119             <span class="keywordflow">break</span>;
<a name="l01120"></a>01120         <span class="keywordflow">case</span> <a class="code" href="xml__parser__cosim_8h.html#a1e0354e1cfa4d729a8b30688d18256fdacdf46b059af7e2210dd6d5af340d7b17">astModelDescription</a>:
<a name="l01121"></a>01121             md = (<a class="code" href="structModelDescription.html">ModelDescription</a>*)e;
<a name="l01122"></a>01122             <a class="code" href="xml__parser__cosim_8c.html#a4e5e1ae04eeb5a5d6bba207e0123e713" title="Free list.">freeList</a>((<span class="keywordtype">void</span> **)md-&gt;<a class="code" href="structModelDescription.html#ade439f086da5269853dbace7e2a2f409">unitDefinitions</a>);
<a name="l01123"></a>01123             <a class="code" href="xml__parser__cosim_8c.html#a4e5e1ae04eeb5a5d6bba207e0123e713" title="Free list.">freeList</a>((<span class="keywordtype">void</span> **)md-&gt;<a class="code" href="structModelDescription.html#a0408f6b6e30e0d722138a25297c01d03">typeDefinitions</a>);
<a name="l01124"></a>01124             <a class="code" href="xml__parser__cosim_8c.html#aaebcecf323c362bc8d9fe1765a0586dd" title="Free element which may contain list of elements.">freeElement</a>(md-&gt;<a class="code" href="structModelDescription.html#a22fe0fbf22cbca568f485475bcac8274">defaultExperiment</a>);
<a name="l01125"></a>01125             <a class="code" href="xml__parser__cosim_8c.html#a4e5e1ae04eeb5a5d6bba207e0123e713" title="Free list.">freeList</a>((<span class="keywordtype">void</span> **)md-&gt;<a class="code" href="structModelDescription.html#a1d4be70fe69967905e5a9a49cd5370b8">vendorAnnotations</a>);
<a name="l01126"></a>01126             <a class="code" href="xml__parser__cosim_8c.html#a4e5e1ae04eeb5a5d6bba207e0123e713" title="Free list.">freeList</a>((<span class="keywordtype">void</span> **)md-&gt;<a class="code" href="structModelDescription.html#a06f6c51301bd9921b391a7b7584b945e">modelVariables</a>);
<a name="l01127"></a>01127             <a class="code" href="xml__parser__cosim_8c.html#a4e5e1ae04eeb5a5d6bba207e0123e713" title="Free list.">freeList</a>((<span class="keywordtype">void</span> **)md-&gt;<a class="code" href="structModelDescription.html#a867d717c11dd3fb2819575c8a00a4334">implementation</a>); <span class="comment">// added M. Wetter</span>
<a name="l01128"></a>01128             <span class="keywordflow">break</span>;
<a name="l01129"></a>01129     }
<a name="l01130"></a>01130     <span class="comment">// free the struct</span>
<a name="l01131"></a>01131     free(e);
<a name="l01132"></a>01132 }
<a name="l01133"></a>01133 
<a name="l01139"></a><a class="code" href="xml__parser__cosim_8c.html#a4e5e1ae04eeb5a5d6bba207e0123e713">01139</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="xml__parser__cosim_8c.html#a4e5e1ae04eeb5a5d6bba207e0123e713" title="Free list.">freeList</a>(<span class="keywordtype">void</span>** list){
<a name="l01140"></a>01140     <span class="keywordtype">int</span> <a class="code" href="fmuTemplate_8h.html#ad51f78a2c68c740b5b1d4fa9bda8500f">i</a>;
<a name="l01141"></a>01141     <span class="keywordflow">if</span> (!list) <span class="keywordflow">return</span>;
<a name="l01142"></a>01142     <span class="keywordflow">for</span> (i=0; list[<a class="code" href="fmuTemplate_8h.html#ad51f78a2c68c740b5b1d4fa9bda8500f">i</a>]; i++) 
<a name="l01143"></a>01143         <a class="code" href="xml__parser__cosim_8c.html#aaebcecf323c362bc8d9fe1765a0586dd" title="Free element which may contain list of elements.">freeElement</a>(list[i]);
<a name="l01144"></a>01144     free(list);
<a name="l01145"></a>01145 }
<a name="l01146"></a>01146 
<a name="l01152"></a><a class="code" href="xml__parser__cosim_8c.html#a10f4783b350987a10d5f4467c8efe273">01152</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="xml__parser__cosim_8c.html#a10f4783b350987a10d5f4467c8efe273" title="Clean file and memory.">cleanup</a>(FILE *file) {
<a name="l01153"></a>01153     <a class="code" href="stack_8c.html#a5a76ee63d08bb1f66bd73118552f13d4">stackFree</a>(stack);
<a name="l01154"></a>01154     stack = NULL;
<a name="l01155"></a>01155     <a class="code" href="expat_8h.html#a6911b3212a330e3d23bdd8e1b433d59e">XML_ParserFree</a>(<a class="code" href="xml__parser__cosim_8c.html#ae610b1239dcb18c41bb131788ca4b520">parser</a>);
<a name="l01156"></a>01156     <a class="code" href="xml__parser__cosim_8c.html#ae610b1239dcb18c41bb131788ca4b520">parser</a> = NULL;
<a name="l01157"></a>01157     fclose(file);
<a name="l01158"></a>01158 }
<a name="l01159"></a>01159 
<a name="l01166"></a><a class="code" href="xml__parser__cosim_8h.html#a9a5414d298c36bfedc74bbbd99f9809d">01166</a> <a class="code" href="structModelDescription.html">ModelDescription</a>* <a class="code" href="xml__parser__cosim_8c.html#a9a5414d298c36bfedc74bbbd99f9809d" title="Parse the fmu.">parse</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* xmlPath) {
<a name="l01167"></a>01167   <a class="code" href="structModelDescription.html">ModelDescription</a>* md = NULL;
<a name="l01168"></a>01168   FILE *file;
<a name="l01169"></a>01169   <span class="keywordtype">int</span> done = 0;
<a name="l01170"></a>01170 
<a name="l01171"></a>01171   stack = <a class="code" href="stack_8c.html#aae29d0a3ec7f0565fbcc88ec53d9b286">stackNew</a>(100, 10); <span class="comment">// Allocate stack memory     </span>
<a name="l01172"></a>01172   <span class="keywordflow">if</span> (<a class="code" href="xml__parser__cosim_8c.html#a68ac634c587e1398100b92d34728b391" title="Various checks that log an error and stop the parser.">checkPointer</a>(stack)) <span class="keywordflow">return</span> NULL;  <span class="comment">// Check if the stack is creatted</span>
<a name="l01173"></a>01173 
<a name="l01174"></a>01174   <a class="code" href="xml__parser__cosim_8c.html#ae610b1239dcb18c41bb131788ca4b520">parser</a> = <a class="code" href="expat_8h.html#a170e5a6b1a8ae0534d3d69f93aa15b0c">XML_ParserCreate</a>(NULL); <span class="comment">// Create an parser</span>
<a name="l01175"></a>01175   <span class="keywordflow">if</span> (<a class="code" href="xml__parser__cosim_8c.html#a68ac634c587e1398100b92d34728b391" title="Various checks that log an error and stop the parser.">checkPointer</a>(<a class="code" href="xml__parser__cosim_8c.html#ae610b1239dcb18c41bb131788ca4b520">parser</a>)) <span class="keywordflow">return</span> NULL;  <span class="comment">// Check if the parser is created</span>
<a name="l01176"></a>01176 
<a name="l01177"></a>01177   <a class="code" href="expat_8h.html#a69921a6d7f1be3d717332cea5e7ceca8">XML_SetElementHandler</a>(<a class="code" href="xml__parser__cosim_8c.html#ae610b1239dcb18c41bb131788ca4b520">parser</a>, <a class="code" href="xml__parser__cosim_8c.html#a5ffcddbdfcedd3ce33f9ec157b32cd4b" title="Callback functions called by the XML parser.">startElement</a>, <a class="code" href="xml__parser__cosim_8c.html#abccdfade4523600bb2c0f5e7dadfd72a" title="Pop the children from the stack and check for correct type and sequence of children This is the end h...">endElement</a>); <span class="comment">// Set handler for start and end tags</span>
<a name="l01178"></a>01178   <a class="code" href="expat_8h.html#affa8d2057a1e75fe4e1c7de26c70cd24">XML_SetCharacterDataHandler</a>(<a class="code" href="xml__parser__cosim_8c.html#ae610b1239dcb18c41bb131788ca4b520">parser</a>, <a class="code" href="xml__parser__cosim_8c.html#a2fdc2e8b1023b7165274430f6f54f470" title="Handle element data.">handleData</a>); <span class="comment">// Set handler for text</span>
<a name="l01179"></a>01179 
<a name="l01180"></a>01180     file = fopen(xmlPath, <span class="stringliteral">&quot;rb&quot;</span>);
<a name="l01181"></a>01181     <span class="keywordflow">if</span> (file == NULL) {
<a name="l01182"></a>01182     <a class="code" href="util_8c.html#a8fce13928a0330cbd29ca38d3301709b" title="Print formatted error message.">printfError</a>(<span class="stringliteral">&quot;Cannot open file &#39;%s&#39;\n&quot;</span>, xmlPath);
<a name="l01183"></a>01183     <a class="code" href="expat_8h.html#a6911b3212a330e3d23bdd8e1b433d59e">XML_ParserFree</a>(<a class="code" href="xml__parser__cosim_8c.html#ae610b1239dcb18c41bb131788ca4b520">parser</a>); <span class="comment">// Free the memory for parser</span>
<a name="l01184"></a>01184     <span class="keywordflow">return</span> NULL; <span class="comment">// Failure</span>
<a name="l01185"></a>01185   }
<a name="l01186"></a>01186 
<a name="l01187"></a>01187   <span class="keywordflow">while</span> (!done) {
<a name="l01188"></a>01188     <span class="keywordtype">int</span> n = fread(<a class="code" href="xml__parser__cosim_8c.html#ab35babda713de8db4d69c1f38c776b12">text</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), <a class="code" href="xml__parser__cosim_8c.html#a0d052f24a8ae31bc7352f7e019223a0e">XMLBUFSIZE</a>, file); <span class="comment">// Read XMLBUFSIZE characters from file</span>
<a name="l01189"></a>01189     <span class="keywordflow">if</span> (n != <a class="code" href="xml__parser__cosim_8c.html#a0d052f24a8ae31bc7352f7e019223a0e">XMLBUFSIZE</a>) done = 1; <span class="comment">// Reach the end of file</span>
<a name="l01190"></a>01190     <span class="keywordflow">if</span> (!<a class="code" href="expat_8h.html#a74b71c0c1edba09393f8450a5cff20f7">XML_Parse</a>(<a class="code" href="xml__parser__cosim_8c.html#ae610b1239dcb18c41bb131788ca4b520">parser</a>, <a class="code" href="xml__parser__cosim_8c.html#ab35babda713de8db4d69c1f38c776b12">text</a>, n, done)){
<a name="l01191"></a>01191       printf(<span class="stringliteral">&quot;Parse error in file %s at line %d:\n%s\n&quot;</span>,
<a name="l01192"></a>01192              xmlPath,
<a name="l01193"></a>01193              (<span class="keywordtype">int</span>)XML_GetCurrentLineNumber(<a class="code" href="xml__parser__cosim_8c.html#ae610b1239dcb18c41bb131788ca4b520">parser</a>),
<a name="l01194"></a>01194               <a class="code" href="expat_8h.html#a8251288f9a95e1da7eb24bdb29ee586b">XML_ErrorString</a>(<a class="code" href="expat_8h.html#a2c9bf949546187a0b6090ecb008a3ea2">XML_GetErrorCode</a>(<a class="code" href="xml__parser__cosim_8c.html#ae610b1239dcb18c41bb131788ca4b520">parser</a>)));
<a name="l01195"></a>01195       <span class="keywordflow">while</span> (!<a class="code" href="stack_8c.html#ad2cd82544211c293edc1e540475673eb">stackIsEmpty</a>(stack)) md = <a class="code" href="stack_8c.html#a9842be4ad74e7117c9fb021d46c6a6a7">stackPop</a>(stack);
<a name="l01196"></a>01196       <span class="keywordflow">if</span> (md) <a class="code" href="xml__parser__cosim_8c.html#aaebcecf323c362bc8d9fe1765a0586dd" title="Free element which may contain list of elements.">freeElement</a>(md);
<a name="l01197"></a>01197       <a class="code" href="xml__parser__cosim_8c.html#a10f4783b350987a10d5f4467c8efe273" title="Clean file and memory.">cleanup</a>(file);
<a name="l01198"></a>01198       <span class="keywordflow">return</span> NULL; <span class="comment">// failure</span>
<a name="l01199"></a>01199     }
<a name="l01200"></a>01200   }
<a name="l01201"></a>01201 
<a name="l01202"></a>01202   md = <a class="code" href="stack_8c.html#a9842be4ad74e7117c9fb021d46c6a6a7">stackPop</a>(stack);
<a name="l01203"></a>01203   assert(<a class="code" href="stack_8c.html#ad2cd82544211c293edc1e540475673eb">stackIsEmpty</a>(stack));
<a name="l01204"></a>01204   <a class="code" href="xml__parser__cosim_8c.html#a10f4783b350987a10d5f4467c8efe273" title="Clean file and memory.">cleanup</a>(file);
<a name="l01205"></a>01205   <span class="comment">//printElement(1, md); // Print the element for debugging</span>
<a name="l01206"></a>01206   <a class="code" href="xml__parser__cosim_8c.html#ab66eb373a3ed73c50cedeae72430a980" title="Generate idf file for EnergyPlus.">printidf</a>(md);
<a name="l01207"></a>01207   <span class="keywordflow">return</span> md; <span class="comment">// Success if all refs are valid    </span>
<a name="l01208"></a>01208 }
<a name="l01209"></a>01209 
<a name="l01210"></a>01210 
</pre></div></div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="xml__parser__cosim_8c.html">xml_parser_cosim.c</a>      </li>
      <li class="footer">Generated on Thu Dec 22 2011 11:07:05 for Functional Mockup Interface For EnergyPlus by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </li>
    </ul>
  </div>

</body>
</html>
